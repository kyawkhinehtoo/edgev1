import{H as C,z as g,c as L,w as y,m as M,N as P,o as a,a as e,d as l,f as r,t as i,F as k,g as E,e as S,j as D,v as N,k as $,b as h}from"./app-CfY6ZqQ3.js";import{A as B}from"./AppLayout-BpveqGu2.js";import{P as j}from"./Pagination-Dsi9Bvye.js";import A from"./EditTempInvoiceItem-CQNJn5dY.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-nIemgTVi.js";const U=C({components:{AppLayout:B,Pagination:j,Link:M,EditTempInvoiceItem:A},props:{tempInvoiceItems:Object,tempInvoices:Object},data(){return{showEditModal:!1,selectedItem:null,filters:{type:"",search:""}}},computed:{filteredItems(){return this.tempInvoiceItems.data.filter(s=>{const t=!this.filters.type||s.type===this.filters.type,n=!this.filters.search||s.customer.name.toLowerCase().includes(this.filters.search.toLowerCase());return t&&n})}},methods:{formatDate(s){return s?new Date(s).toLocaleDateString():""},openEditModal(s){console.log(s),this.selectedItem=s,this.showEditModal=!0},closeEditModal(){this.showEditModal=!1,this.selectedItem=null},deleteItem(s){confirm("Are you sure you want to delete this item?")&&P.delete(route("tempInvoiceItems.destroy",s.id),{onSuccess:t=>{Toast.fire({icon:"success",title:t.props.flash.message})},onError:t=>{console.error("Error submitting form:",t)}})},formatNumber(s){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0)},doExcel(){var t;let s=Object.create({});s.id=(t=this.tempInvoiceItems.data[0])==null?void 0:t.temp_invoice_id,axios.post("/exportTempBillingItemExcel",s,{responseType:"blob"}).then(n=>{var p,c,m,u;console.log(n);var f=document.createElement("a");document.body.appendChild(f),f.style="display: none";var v=new Blob([n.data],{type:n.headers["content-type"]});const d=document.createElement("a");d.href=window.URL.createObjectURL(v),d.download=`temp_billings_${(p=this.tempInvoiceItems.data[0].temp_invoice.isp)==null?void 0:p.name}_${(u=(m=(c=this.tempInvoiceItems.data[0])==null?void 0:c.temp_invoice)==null?void 0:m.temp_bill)==null?void 0:u.bill_number}_${new Date().toISOString().split("T")[0]}.xlsx`,d.click()})}}}),V={class:"py-12"},O={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},z={key:0,class:"mb-6 grid grid-cols-4 gap-4"},H={class:"space-y-2 col-span-2"},Q={class:"text-lg space-y-1"},Y={class:"space-y-2 col-span-2"},q={class:"bg-gray-50 rounded p-2 text-sm"},G={class:"col-span-2 truncate"},J={class:"text-center"},K={class:"text-right font-medium"},W={class:"mt-8"},X={class:"flex justify-between items-center mb-4"},Z={class:"flex space-x-4"},ee={class:"w-48"},te={class:"w-64"},se={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200"},ie={class:"bg-white divide-y divide-gray-200"},ne={class:"px-6 py-4 whitespace-nowrap"},ae={class:"px-6 py-4 whitespace-nowrap"},le={class:"px-6 py-4 whitespace-nowrap"},re={class:"px-6 py-4 whitespace-nowrap"},de={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap"},me=["onClick"],ue=["onClick"],ge={class:"mt-4"},fe={class:"mt-6 flex justify-end space-x-3"};function ye(s,t,n,f,v,d){const p=g("Pagination"),c=g("Link"),m=g("EditTempInvoiceItem"),u=g("AppLayout");return a(),L(u,{title:"Invoice Details"},{header:y(()=>t[3]||(t[3]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"}," Invoice Details ",-1)])),default:y(()=>{var x,b,w,I,_;return[e("div",V,[e("div",O,[e("div",R,[s.tempInvoiceItems.data.length>0?(a(),l("div",z,[e("div",H,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold"},"Invoice Info",-1)),e("div",Q,[e("p",null,[t[4]||(t[4]=e("span",{class:"font-medium"},"ISP:",-1)),r(" "+i((x=s.tempInvoiceItems.data[0].temp_invoice.isp)==null?void 0:x.name),1)]),e("p",null,[t[5]||(t[5]=e("span",{class:"font-medium"},"Bill Period:",-1)),r(" "+i((w=(b=s.tempInvoiceItems.data[0].temp_invoice)==null?void 0:b.temp_bill)==null?void 0:w.billing_period),1)]),e("p",null,[t[6]||(t[6]=e("span",{class:"font-medium"},"Status:",-1)),r(" "+i((_=(I=s.tempInvoiceItems.data[0].temp_invoice)==null?void 0:I.temp_bill)==null?void 0:_.status),1)])])]),e("div",Y,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold"},"Summary Brakedown",-1)),e("div",q,[t[8]||(t[8]=e("div",{class:"grid grid-cols-4 gap-2 border-b border-gray-200 pb-1 mb-1"},[e("div",{class:"col-span-2 font-medium text-gray-600"},"Description"),e("div",{class:"text-center font-medium text-gray-600"},"QTY"),e("div",{class:"text-right font-medium text-gray-600"},"Total")],-1)),(a(!0),l(k,null,E(s.tempInvoices,o=>(a(),l("div",{key:o.category,class:"grid grid-cols-4 gap-2 py-1 hover:bg-gray-100"},[e("div",G,i(o.category),1),e("div",J,i(o.total_customers),1),e("div",K,i(s.formatNumber(o.total_amount)),1)]))),128))])])])):S("",!0),e("div",W,[e("div",X,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold"},"Invoice Items",-1)),e("div",Z,[e("div",ee,[D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.filters.type=o),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},t[10]||(t[10]=[e("option",{value:""},"All Types",-1),e("option",{value:"FullPortLeasing"},"Full Portleasing",-1),e("option",{value:"ProRatedPortLeasing"},"Pro-rated Portleasing",-1),e("option",{value:"NewInstallation"},"New Installation",-1),e("option",{value:"Materials"},"Materials",-1),e("option",{value:"Maintenance"},"Maintenance",-1),e("option",{value:"Suspension"},"Suspension",-1)]),512),[[N,s.filters.type]])]),e("div",te,[D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.filters.search=o),type:"text",placeholder:"Search customer name...",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[$,s.filters.search]])]),e("div",null,[e("a",{onClick:t[2]||(t[2]=(...o)=>s.doExcel&&s.doExcel(...o)),class:"cursor-pointer inline-flex items-center px-2 py-2 bg-green-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:ring focus:ring-green-300 disabled:opacity-25 transition"},t[11]||(t[11]=[r("Export "),e("i",{class:"ml-1 fa fa-download text-white"},null,-1)]))])])]),e("div",se,[e("table",oe,[t[13]||(t[13]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Customer"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Period"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Unit Price"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",ie,[(a(!0),l(k,null,E(s.filteredItems,o=>(a(),l("tr",{key:o.id,class:"hover:bg-gray-50"},[e("td",ne,i(o.customer.ftth_id),1),e("td",ae,i(o.customer.name),1),e("td",le,i(o.type),1),e("td",re,i(s.formatDate(o.start_date))+" - "+i(s.formatDate(o.end_date)),1),e("td",de,"$"+i(o.unit_price),1),e("td",pe,"$"+i(o.total_amount),1),e("td",ce,[e("button",{onClick:T=>s.openEditModal(o),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,me),e("button",{onClick:T=>s.deleteItem(o),class:"text-red-600 hover:text-red-900"}," Delete ",8,ue)])]))),128))])])]),e("div",ge,[h(p,{links:s.tempInvoiceItems.links},null,8,["links"])])]),e("div",fe,[h(c,{href:s.route("tempBilling"),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"},{default:y(()=>t[14]||(t[14]=[r(" Back to List ")])),_:1},8,["href"])])])])]),h(m,{show:s.showEditModal,invoiceItem:s.selectedItem,onClose:s.closeEditModal},null,8,["show","invoiceItem","onClose"])]}),_:1})}const _e=F(U,[["render",ye]]);export{_e as default};
