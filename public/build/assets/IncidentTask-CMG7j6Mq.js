import{A as L,N as E}from"./NoData-CMoasrAh.js";import{P as Y}from"./Pagination-BDaU9i64.js";import{i as F,r as f,D as K,K as q,q as B,c as G,w as H,N as S,o as i,a as e,d,s as N,v as O,L as J,n as k,e as r,F as W,g as U,t as n,b as z,A as Q,f as R}from"./app-DdoqqyeN.js";import{M as X}from"./vue3-multiselect.umd.min-BtFOAPRA.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DupIRA2Y.js";const $={name:"IncidentTask",components:{AppLayout:L,Pagination:Y,Multiselect:X,NoData:E,Link:F},props:{tasks:Object,errors:Object,task_write:Boolean,user:Object,noc:Object,critical:Number,high:Number,normal:Number,role:Object,subcons:Object,subcon:Object},setup(u){const t=f("");f("");let c=f(!1),s=f(!1),y=f(!1);f("");let g=f(1),x=f("my");const I=f({date:"YYYY-MM-DD",month:"MMM"});f(!1),K("user",u.user);const l=q({id:null,assigned:null,target:null,status:1,description:null,incident_id:null,data:null});function v(){l.id=null,l.assigned=null,l.target=null,l.status=1,l.description=null,l.data=null,l.incident_id=u.data}function w(a){l.id=a.id,l.assigned=u.subcons.filter(m=>m.id==a.assigned)[0],l.description=a.description,l.incident_id=a.incident_id,l.status=a.status,l.target=a.target,l.data=a,y.value=!0,s.value=!0}function T(a){a.status!=2?Toast.fire({title:"Are you sure?",text:"Do you want to mark as completed !",icon:"warning",timer:!1,position:"center",showCancelButton:!0,dangerMode:!0}).then(m=>{m.isConfirmed&&b(a,2)}):Toast.fire({title:"Are you sure?",text:"Do you want to mark as WIP !",icon:"warning",timer:!1,position:"center",showCancelButton:!0,dangerMode:!0}).then(m=>{m.isConfirmed&&b(a,1)})}function b(a,m){l.id=a.id,l.assigned=u.subcons.filter(V=>V.id==a.assigned)[0],l.description=a.description,l.incident_id=a.incident_id,l.status=m,l.target=a.target,y.value=!0,s.value=!1,_()}function _(){y.value!=!0?(l._method="POST",S.post("/addTask",l,{preserveState:!0,onSuccess:a=>{s.value=!1,v(),Toast.fire({icon:"success",title:a.props.flash.message})},onError:a=>{console.log("error .."+a)}})):(l._method="PUT",S.post("/editTask/"+l.id,l,{onSuccess:a=>{s.value=!1,y.value=!1,v(),Toast.fire({icon:"success",title:a.props.flash.message})},onError:a=>{console.log("error .."+a)}}))}function C(){s.value=!1,preserveState=!0}function j(a){let m="WIP";return a==0?m="Deleted":a==1?m="WIP":m="Completed",m}function A(){S.get("/mytask/",{keyword:t.value,status:g.value,task:x.value},{preserveState:!0})}function p(){let a="/mytask/";t.value!=null&&(a=a+"?keyword="+t.value),g.value!=""&&(a=a+"&status="+g.value),x.value!=""&&(a=a+"&task="+x.value),S.get(a,{keyword:t.value},{preserveState:!0})}function D(){g.value=1,p()}function o(){g.value=2,p()}function M(){g.value="all",p()}function h(){x.value="my",p()}function P(){x.value="all",p()}return{search:t,loading:c,form:l,formatter:I,edit:s,editMode:y,search_status:g,task_user:x,getName:a=>{let m=u.subcons.filter(V=>V.id==a)[0];return m?m.name:""},getStatus:j,editTask:w,completeIt:b,saveTask:_,cancelTask:C,completeTask:T,searchTask:A,goWIP:D,goCompleted:o,goAll:M,goMyTasks:h,goAllTasks:P,changeStatus:p}}},ee={class:"py-1"},te={class:"mx-auto sm:px-6 lg:px-8"},se={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-2 py-2 w-full justify-items-end"},oe={class:"flex w-full"},ae={class:"flex w-full"},le={class:"flex w-full"},ne={key:1},ie={key:0,class:"hidden md:block"},de={class:"min-w-full divide-y divide-gray-200 table-auto"},re={class:"bg-white divide-y divide-gray-200 text-sm w-full text-left"},ce={class:"px-2 py-3 whitespace-nowrap"},me={class:"px-6 py-3 whitespace-nowrap w-1/12"},ue=["checked","onClick","disabled"],fe={class:"px-6 py-3 whitespace-nowrap"},pe={class:"px-6 py-3 whitespace-nowrap"},ge={class:"px-6 py-3 whitespace-nowrap"},xe={class:"px-6 py-3 whitespace-nowrap"},ye={class:"px-6 py-3 whitespace-nowrap"},be={class:"px-6 py-3 whitespace-nowrap"},ke={class:"px-6 py-3 whitespace-nowrap"},ve=["onClick"],_e={key:1,class:"grid grid-cols-1 sm:grid-cols-2 gap-2 md:hidden"},he={class:"flex items-center justify-between space-x-2 text-sm"},we={class:"font-bold"},Te={class:"text-sm text-gray-600"},Ce={class:"font-sm p-2 capitalize"},je={class:"mt-4"},Ae={class:"text-xs text-gray-700"},De={class:"text-xs text-gray-700"},Me={class:"text-xs text-gray-700"},Se={class:"flex flex-wrap justify-end"},Ne=["onClick"],Ie={key:2,class:"w-full block mt-4"},Pe={class:"text-xs text-gray-600"},Ve={key:3},Be={key:2,class:"grid grid-cols-1 md:grid-cols-4 gap-2 w-full bg-white p-4"},Oe={class:"md:py-2 md:col-span-3 col-span-1"},We={class:"flex"},Ue={for:"ftth_id",class:"block text-sm font-bold text-gray-700 md:mt-2 md:mr-2"},ze={class:"md:py-2 md:col-span-3 col-span-1"},Le={class:"flex"},Ee={for:"type",class:"block text-sm font-bold text-gray-700 md:mt-2 md:mr-2 capitalize"},Ye={key:0,class:"py-2 col-span-1 w-full"},Fe={key:1,class:"md:py-2 md:col-span-3 col-span-1"},Ke={class:"flex"},qe={for:"type",class:"block text-sm font-bold text-gray-700 md:mt-2 md:mr-2 capitalize"},Ge={class:"md:py-2 md:col-span-3 col-span-1"},He={class:"flex"},Je={for:"type",class:"block text-sm font-bold text-gray-700 md:mt-2 md:mr-2 whitespace-normal"},Qe={class:"md:py-2 md:col-span-3 col-span-1"},Re={class:"flex"},Xe={for:"type",class:"block text-sm font-bold text-gray-700 md:mt-2 md:mr-2 whitespace-normal"},Ze={class:"md:py-2 md:col-span-3 col-span-1"},$e={class:"flex rounded-md shadow-sm"},et={key:0,class:"flex rounded-md shadow-sm w-full"},tt={key:1,class:"mt-2 text-sm text-red-500"},st={class:"md:py-2 col-span-1 md:col-span-3"},ot={class:"flex rounded-md shadow-sm"},at={key:0,class:"mt-2 text-sm text-red-500"},lt={class:"md:py-2 col-span-1 md:col-span-3"},nt={class:"flex rounded-md shadow-sm"},it={key:0,class:"mt-2 text-sm text-red-500"},dt={class:"md:py-2 col-span-1 md:col-span-3"},rt={class:"flex rounded-md shadow-sm"},ct={key:0,class:"mt-2 text-sm text-red-500"},mt={class:"col-span-1 md:col-span-4 flex md:justify-end justify-between mt-4"},ut={key:0},ft={key:1},pt={key:0,"wire:loading":"",class:"fixed top-0 left-0 right-0 bottom-0 w-full h-screen z-50 overflow-hidden bg-gray-700 opacity-75 flex flex-col items-center justify-center"};function gt(u,t,c,s,y,g){const x=B("pagination"),I=B("multiselect"),l=B("app-layout");return i(),G(l,null,{default:H(()=>{var v,w,T,b,_,C,j,A,p,D;return[e("div",ee,[e("div",te,[s.edit?r("",!0):(i(),d("div",se,[e("div",oe,[t[13]||(t[13]=e("span",{class:"z-10 mt-1 leading-snug font-normal text-center text-blueGray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-search"})],-1)),N(e("input",{type:"text",placeholder:"ID/Description",class:"pl-10 pr-12 py-2.5 w-full rounded-lg overflow-hidden text-sm text-litepie-secondary-700 placeholder-litepie-secondary-400 transition-colors bg-white border border-litepie-secondary-300 focus:border-litepie-primary-300 focus:ring focus:ring-litepie-primary-500 focus:ring-opacity-10 focus:outline-none dark:bg-litepie-secondary-800 dark:border-litepie-secondary-700 dark:text-litepie-secondary-100 dark:placeholder-litepie-secondary-500 dark:focus:border-litepie-primary-500 dark:focus:ring-opacity-20",id:"search",tabindex:"1","onUpdate:modelValue":t[0]||(t[0]=o=>s.search=o),onKeyup:t[1]||(t[1]=J((...o)=>s.searchTask&&s.searchTask(...o),["enter"]))},null,544),[[O,s.search]])]),e("div",ae,[e("button",{class:k(["w-full btn py-3 px-8 bg-gray-400 rounded rounded-r-none focus:ring-0 focus:border-transparent focus:outline-none focus:shadow-inner text-gray-50 text-xs font-semibold uppercase",{"bg-yellow-300 text-gray-600 font-bold":s.search_status==1}]),onClick:t[2]||(t[2]=(...o)=>s.goWIP&&s.goWIP(...o))},"WIP",2),e("button",{class:k(["w-full btn py-3 px-8 bg-gray-400 focus:ring-0 focus:border-transparent focus:outline-none focus:shadow-inner text-gray-50 text-xs font-semibold uppercase",{"bg-green-300 text-gray-600 font-bold":s.search_status==2}]),onClick:t[3]||(t[3]=(...o)=>s.goCompleted&&s.goCompleted(...o))},"Completed",2),e("button",{class:k(["w-full btn py-3 px-8 bg-gray-400 rounded rounded-l-none focus:ring-0 focus:border-transparent focus:outline-none focus:shadow-inner text-gray-50 text-xs font-semibold uppercase",{"bg-indigo-600 font-bold":s.search_status=="all"}]),onClick:t[4]||(t[4]=(...o)=>s.goAll&&s.goAll(...o))},"All",2)]),e("div",le,[e("button",{class:k(["w-full btn py-3 px-8 bg-gray-400 rounded rounded-r-none focus:ring-0 focus:border-transparent focus:outline-none focus:shadow-inner text-gray-50 text-xs font-semibold uppercase",{"bg-yellow-300 text-gray-600 font-bold":s.task_user=="my"}]),onClick:t[5]||(t[5]=(...o)=>s.goMyTasks&&s.goMyTasks(...o))},"My Tasks",2),e("button",{class:k(["w-full btn py-3 px-8 bg-gray-400 rounded rounded-l-none focus:ring-0 focus:border-transparent focus:outline-none focus:shadow-inner text-gray-50 text-xs font-semibold uppercase",{"bg-indigo-600 font-bold":s.task_user=="all"}]),onClick:t[6]||(t[6]=(...o)=>s.goAllTasks&&s.goAllTasks(...o))},"All",2)])])),s.edit?r("",!0):(i(),d("div",ne,[(v=c.tasks)!=null&&v.data?(i(),d("div",ie,[e("table",de,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer ID"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Assigned To"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Assigned By"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Target Date"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Action")])],-1)),e("tbody",re,[(i(!0),d(W,null,U(c.tasks.data,(o,M)=>{var h;return i(),d("tr",{key:o.id},[e("td",ce,n(M+=c.tasks.from),1),e("td",me,[e("input",{type:"checkbox",name:"status",checked:o.status==2,onClick:P=>s.completeTask(o),disabled:!c.task_write},null,8,ue)]),e("td",fe,n(o.ftth_id),1),e("td",pe,n((h=o.description)==null?void 0:h.substring(0,50)),1),e("td",ge,n(s.getName(o.assigned)),1),e("td",xe,n(o.incharge.match(/\b\w/g).join("")),1),e("td",ye,n(o.target),1),e("td",be,n(s.getStatus(o.status)),1),e("td",ke,[e("a",{href:"#",onClick:P=>s.editTask(o),class:"text-blue-600"},t[14]||(t[14]=[e("i",{class:"fa fa-edit"},null,-1)]),8,ve)])])}),128))])])])):r("",!0),(w=c.tasks)!=null&&w.data?(i(),d("div",_e,[(i(!0),d(W,null,U(c.tasks.data,(o,M)=>(i(),d("div",{class:"bg-white p-4 rounded-lg shadow mt-2 space-y-1 text-gray-600",key:o.id},[e("div",he,[e("label",we,n(o.ftth_id),1),e("div",null,[e("span",{class:k(["text-xs font-bold px-2.5 py-0.5 rounded items-center justify-center",{"bg-yellow-400":o.status==1,"bg-green-300":o.status!=1}])},n(s.getStatus(o.status)),3)])]),e("div",Te,[t[16]||(t[16]=e("label",{for:"details",class:"w-full font-bold"}," Description ",-1)),e("p",Ce,n(o.description),1)]),e("span",je,[e("div",Ae," Assigned To : "+n(o.assigned_to),1),e("div",De," Assigned By : "+n(o.incharge),1),e("div",Me," Target Date : "+n(o.target),1)]),e("div",Se,[e("div",null,[e("a",{type:"button",onClick:h=>s.editTask(o),href:"#",class:"bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-30 items-center justify-center"},t[17]||(t[17]=[e("span",{class:"text-sm"},"Edit",-1),e("i",{class:"fa fa-angle-double-right fa-lg ml-2","aria-hidden":"true"},null,-1)]),8,Ne)])])]))),128))])):r("",!0),c.tasks.total?(i(),d("span",Ie,[e("label",Pe,n(c.tasks.data.length)+" Tasks in Current Page. Total Number of Tasks : "+n(c.tasks.total),1)])):r("",!0),c.tasks.links?(i(),d("span",Ve,[z(x,{class:"mt-4",links:c.tasks.links},null,8,["links"])])):r("",!0)])),s.edit?(i(),d("div",Be,[t[22]||(t[22]=e("div",{class:"py-2 col-span-1 w-full"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Customer ID : ")])],-1)),e("div",Oe,[e("div",We,[e("label",Ue,n((T=s.form.data)==null?void 0:T.ftth_id),1)])]),t[23]||(t[23]=e("div",{class:"py-2 col-span-1 w-full"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Ticket Type : ")])],-1)),e("div",ze,[e("div",Le,[e("label",Ee,n((b=s.form.data)==null?void 0:b.type.replace("_"," ")),1)])]),(_=s.form.data)!=null&&_.topic?(i(),d("div",Ye,t[18]||(t[18]=[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Ticket Topic : ")],-1)]))):r("",!0),(C=s.form.data)!=null&&C.topic?(i(),d("div",Fe,[e("div",Ke,[e("label",qe,n((j=s.form.data)==null?void 0:j.topic.replace("_"," ")),1)])])):r("",!0),t[24]||(t[24]=e("div",{class:"py-2 col-span-1 w-full"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Ticket Detail : ")])],-1)),e("div",Ge,[e("div",He,[e("label",Je,n((A=s.form.data)==null?void 0:A.incident_description),1)])]),t[25]||(t[25]=e("div",{class:"py-2 col-span-1 w-full"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Ticket Opened At : ")])],-1)),e("div",Qe,[e("div",Re,[e("label",Xe,n((p=s.form.data)==null?void 0:p.date)+" : "+n((D=s.form.data)==null?void 0:D.time),1)])]),t[26]||(t[26]=e("div",{class:"py-2 col-span-1 w-full"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"assigned",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Assigned : ")])],-1)),e("div",Ze,[e("div",$e,[c.subcons.length!==0?(i(),d("div",et,[z(I,{"deselect-label":"Selected already",options:c.subcons,"track-by":"id",label:"name",modelValue:s.form.assigned,"onUpdate:modelValue":t[7]||(t[7]=o=>s.form.assigned=o),"allow-empty":!1,multiple:!1},null,8,["options","modelValue"])])):r("",!0),u.$page.props.errors.assigned?(i(),d("p",tt,n(u.$page.props.errors.assigned),1)):r("",!0)])]),t[27]||(t[27]=e("div",{class:"py-2 col-span-1 sm:col-span-1"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"target",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Target : ")])],-1)),e("div",st,[e("div",ot,[N(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=o=>s.form.target=o),name:"target",id:"target",class:"form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300"},null,512),[[O,s.form.target]])]),u.$page.props.errors.target?(i(),d("p",at,n(u.$page.props.errors.target),1)):r("",!0)]),t[28]||(t[28]=e("div",{class:"py-2 col-span-1 sm:col-span-1"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"description",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Description : ")])],-1)),e("div",lt,[e("div",nt,[N(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=o=>s.form.description=o),name:"description",id:"description",class:"form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300"},null,512),[[O,s.form.description]])]),u.$page.props.errors.description?(i(),d("p",it,n(u.$page.props.errors.description),1)):r("",!0)]),t[29]||(t[29]=e("div",{class:"py-2 col-span-1 sm:col-span-1"},[e("div",{class:"flex md:justify-end"},[e("label",{for:"description",class:"block text-sm font-medium text-gray-700 md:mt-2 md:mr-2"}," Status : ")])],-1)),e("div",dt,[e("div",rt,[N(e("select",{"onUpdate:modelValue":t[10]||(t[10]=o=>s.form.status=o),class:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300"},t[19]||(t[19]=[e("option",{value:"1"},"WIP",-1),e("option",{value:"2"},"Completed",-1),e("option",{value:"0"},"Deleted",-1)]),512),[[Q,s.form.status]])]),u.$page.props.errors.status?(i(),d("p",ct,n(u.$page.props.errors.status),1)):r("",!0)]),e("div",mt,[e("a",{href:"#",onClick:t[11]||(t[11]=o=>s.saveTask()),class:"text-center px-4 py-3 bg-green-500 border border-transparent rounded-sm font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-400 active:bg-green-600 focus:outline-none focus:border-gray-900 disabled:opacity-25 transition mr-1"},[s.editMode?r("",!0):(i(),d("span",ut,"Save Task")),s.editMode?(i(),d("span",ft,"Update Task")):r("",!0),t[20]||(t[20]=e("i",{class:"fas fa-save opacity-75 ml-1 text-sm"},null,-1))]),e("a",{href:"#",onClick:t[12]||(t[12]=o=>s.cancelTask()),class:"text-center px-4 py-3 bg-gray-500 border border-transparent rounded-sm font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-400 active:bg-gray-600 focus:outline-none focus:border-gray-900 disabled:opacity-25 transition"},t[21]||(t[21]=[R("Cancel"),e("i",{class:"fas fa-save opacity-75 ml-1 text-sm"},null,-1)]))])])):r("",!0)])]),s.loading?(i(),d("div",pt,t[30]||(t[30]=[e("div",{class:"loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"},null,-1),e("h2",{class:"text-center text-white text-xl font-semibold"},"Loading...",-1),e("p",{class:"w-1/3 text-center text-white"},"This may take a few seconds, please don't close this page.",-1)]))):r("",!0)]}),_:1})}const wt=Z($,[["render",gt]]);export{wt as default};
