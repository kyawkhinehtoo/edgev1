import{E as D,q as g,c as L,w as x,i as S,N as T,o as l,a as t,d as a,f as d,t as i,F as k,g as E,e as M,s as N,z as A,v as P,b as v}from"./app-DzBQ2I0X.js";import{A as $}from"./AppLayout-HsoNu0-T.js";import{P as B}from"./Pagination-CCrCsp6e.js";import R from"./EditInvoiceItem-CiyLYeRX.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DoTjPdMl.js";const j=D({components:{AppLayout:$,Pagination:B,Link:S,EditInvoiceItem:R},props:{invoiceItems:Object,invoices:Object},data(){return{showEditModal:!1,selectedItem:null,filters:{type:"",search:""}}},computed:{filteredItems(){return this.invoiceItems.data.filter(e=>{const s=!this.filters.type||e.type===this.filters.type,n=!this.filters.search||e.customer.name.toLowerCase().includes(this.filters.search.toLowerCase());return s&&n})}},methods:{formatDate(e){return e?new Date(e).toLocaleDateString():""},openEditModal(e){console.log(e),this.selectedItem=e,this.showEditModal=!0},closeEditModal(){this.showEditModal=!1,this.selectedItem=null},deleteItem(e){confirm("Are you sure you want to delete this item?")&&T.delete(route("invoiceItems.destroy",e.id),{onSuccess:()=>{}})},formatNumber(e){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e||0)},doExcel(){var s;let e=Object.create({});e.id=(s=this.invoiceItems.data[0])==null?void 0:s.invoice_id,axios.post("/exportBillingItemExcel",e,{responseType:"blob"}).then(n=>{var c,p,m,u;console.log(n);var f=document.createElement("a");document.body.appendChild(f),f.style="display: none";var y=new Blob([n.data],{type:n.headers["content-type"]});const r=document.createElement("a");r.href=window.URL.createObjectURL(y),r.download=`billings_${(c=this.invoiceItems.data[0].invoice.isp)==null?void 0:c.name}_${(u=(m=(p=this.invoiceItems.data[0])==null?void 0:p.invoice)==null?void 0:m.bill)==null?void 0:u.bill_number}_${new Date().toISOString().split("T")[0]}.xlsx`,r.click()})}}}),O={class:"py-12"},U={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},V={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},q={key:0,class:"mb-6 grid grid-cols-4 gap-4"},z={class:"space-y-2"},Q={class:"text-lg space-y-1"},Y={class:"space-y-2"},G={class:"grid grid-cols-2 gap-2"},H={class:"bg-blue-50 rounded p-2 text-center"},J={class:"text-lg font-semibold text-blue-700"},K={class:"bg-blue-50 rounded p-2 text-center"},W={class:"text-lg font-semibold text-blue-700"},X={class:"bg-green-50 rounded p-2 text-center"},Z={class:"text-lg font-semibold text-green-700"},tt={class:"bg-green-50 rounded p-2 text-center"},et={class:"text-lg font-semibold text-green-700"},st={class:"bg-yellow-50 rounded p-2 text-center"},ot={class:"text-lg font-semibold text-yellow-700"},it={class:"bg-yellow-50 rounded p-2 text-center"},nt={class:"text-lg font-semibold text-yellow-700"},lt={class:"space-y-2 col-span-2"},at={class:"bg-gray-50 rounded p-2 text-sm"},dt={class:"col-span-2 truncate"},rt={class:"text-center"},ct={class:"text-right"},pt={class:"text-right font-medium"},mt={class:"mt-8"},ut={class:"flex justify-between items-center mb-4"},gt={class:"flex space-x-4"},ft={class:"w-48"},xt={class:"w-64"},vt={class:"overflow-x-auto"},yt={class:"min-w-full divide-y divide-gray-200"},ht={class:"bg-white divide-y divide-gray-200"},bt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"px-6 py-4 whitespace-nowrap"},_t={class:"px-6 py-4 whitespace-nowrap"},It={class:"px-6 py-4 whitespace-nowrap"},kt={class:"px-6 py-4 whitespace-nowrap"},Et={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"px-6 py-4 whitespace-nowrap"},Ct=["onClick"],Dt=["onClick"],Lt={class:"mt-4"},St={class:"mt-6 flex justify-end space-x-3"};function Tt(e,s,n,f,y,r){const c=g("Pagination"),p=g("Link"),m=g("EditInvoiceItem"),u=g("AppLayout");return l(),L(u,{title:"Invoice Details"},{header:x(()=>s[3]||(s[3]=[t("h2",{class:"font-semibold text-xl text-white leading-tight"}," Invoice Details ",-1)])),default:x(()=>{var h,b,w,_,I;return[t("div",O,[t("div",U,[t("div",V,[e.invoiceItems.data.length>0?(l(),a("div",q,[t("div",z,[s[7]||(s[7]=t("h3",{class:"text-lg font-semibold"},"Invoice Info",-1)),t("div",Q,[t("p",null,[s[4]||(s[4]=t("span",{class:"font-medium"},"ISP:",-1)),d(" "+i((h=e.invoiceItems.data[0].invoice.isp)==null?void 0:h.name),1)]),t("p",null,[s[5]||(s[5]=t("span",{class:"font-medium"},"Bill Period:",-1)),d(" "+i((w=(b=e.invoiceItems.data[0].invoice)==null?void 0:b.temp_bill)==null?void 0:w.billing_period),1)]),t("p",null,[s[6]||(s[6]=t("span",{class:"font-medium"},"Status:",-1)),d(" "+i((I=(_=e.invoiceItems.data[0].invoice)==null?void 0:_.temp_bill)==null?void 0:I.status),1)])])]),t("div",Y,[s[14]||(s[14]=t("h3",{class:"text-lg font-semibold"},"Summary Overview",-1)),t("div",G,[t("div",H,[s[8]||(s[8]=t("p",{class:"text-xs text-blue-600"},"MRC",-1)),t("p",J,i(e.invoiceItems.data[0].invoice.total_mrc_customer),1)]),t("div",K,[s[9]||(s[9]=t("p",{class:"text-xs text-blue-600"},"Total MRC Amount",-1)),t("p",W,i(e.formatNumber(e.invoiceItems.data[0].invoice.total_mrc_amount)),1)]),t("div",X,[s[10]||(s[10]=t("p",{class:"text-xs text-green-600"},"New",-1)),t("p",Z,i(e.invoiceItems.data[0].invoice.total_new_customer),1)]),t("div",tt,[s[11]||(s[11]=t("p",{class:"text-xs text-green-600"},"Total New Amount",-1)),t("p",et,i(e.formatNumber(e.invoiceItems.data[0].invoice.total_installation_amount)),1)]),t("div",st,[s[12]||(s[12]=t("p",{class:"text-xs text-yellow-600"},"Additional",-1)),t("p",ot,i(e.invoiceItems.data[0].invoice.additional_description),1)]),t("div",it,[s[13]||(s[13]=t("p",{class:"text-xs text-yellow-600"},"Total New Amount",-1)),t("p",nt,i(e.formatNumber(e.invoiceItems.data[0].invoice.additional_fees)),1)])])]),t("div",lt,[s[16]||(s[16]=t("h3",{class:"text-lg font-semibold"},"Summary Brakedown",-1)),t("div",at,[s[15]||(s[15]=t("div",{class:"grid grid-cols-5 gap-2 border-b border-gray-200 pb-1 mb-1"},[t("div",{class:"col-span-2 font-medium text-gray-600"},"Description"),t("div",{class:"text-center font-medium text-gray-600"},"QTY"),t("div",{class:"text-right font-medium text-gray-600"},"Price"),t("div",{class:"text-right font-medium text-gray-600"},"Total")],-1)),(l(!0),a(k,null,E(e.invoices,o=>(l(),a("div",{key:o.category,class:"grid grid-cols-5 gap-2 py-1 hover:bg-gray-100"},[t("div",dt,i(o.category),1),t("div",rt,i(o.total_customers),1),t("div",ct,i(e.formatNumber(o.unit_price)),1),t("div",pt,i(e.formatNumber(o.total_amount)),1)]))),128))])])])):M("",!0),t("div",mt,[t("div",ut,[s[19]||(s[19]=t("h3",{class:"text-lg font-semibold"},"Invoice Items",-1)),t("div",gt,[t("div",ft,[N(t("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>e.filters.type=o),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},s[17]||(s[17]=[t("option",{value:""},"All Types",-1),t("option",{value:"FullRecurring"},"Full Recurring",-1),t("option",{value:"ProRatedRecurring"},"Pro-rated Recurring",-1),t("option",{value:"NewInstallation"},"New Installation",-1)]),512),[[A,e.filters.type]])]),t("div",xt,[N(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.filters.search=o),type:"text",placeholder:"Search customer name...",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[P,e.filters.search]])]),t("div",null,[t("a",{onClick:s[2]||(s[2]=(...o)=>e.doExcel&&e.doExcel(...o)),class:"cursor-pointer inline-flex items-center px-2 py-2 bg-green-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:ring focus:ring-green-300 disabled:opacity-25 transition"},s[18]||(s[18]=[d("Export "),t("i",{class:"ml-1 fa fa-download text-white"},null,-1)]))])])]),t("div",vt,[t("table",yt,[s[20]||(s[20]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Customer"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Period"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Unit Price"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Total"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),t("tbody",ht,[(l(!0),a(k,null,E(e.filteredItems,o=>(l(),a("tr",{key:o.id,class:"hover:bg-gray-50"},[t("td",bt,i(o.customer.ftth_id),1),t("td",wt,i(o.customer.name),1),t("td",_t,i(o.type),1),t("td",It,i(e.formatDate(o.start_date))+" - "+i(e.formatDate(o.end_date)),1),t("td",kt,"$"+i(o.unit_price),1),t("td",Et,"$"+i(o.total_amount),1),t("td",Nt,[t("button",{onClick:C=>e.openEditModal(o),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,Ct),t("button",{onClick:C=>e.deleteItem(o),class:"text-red-600 hover:text-red-900"}," Delete ",8,Dt)])]))),128))])])]),t("div",Lt,[v(c,{links:e.invoiceItems.links},null,8,["links"])])]),t("div",St,[v(p,{href:e.route("showbill.show",{bill_id:e.invoiceItems.data[0].invoice.bill_id}),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"},{default:x(()=>s[21]||(s[21]=[d(" Back to List ")])),_:1},8,["href"])])])])]),v(m,{show:e.showEditModal,invoiceItem:e.selectedItem,onClose:e.closeEditModal},null,8,["show","invoiceItem","onClose"])]}),_:1})}const Ft=F(j,[["render",Tt]]);export{Ft as default};
