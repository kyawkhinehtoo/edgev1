import{A as K}from"./AppLayout-DHZa_xSr.js";import{M as R}from"./vue3-multiselect.umd.min-DRlJxICN.js";import{i as Y,r as u,T as H,m as v,p as X,q as V,c as G,w as S,N as J,o as P,a as e,h as Q,f as c,s as l,v as f,x as p,t as m,d as N,b as j,e as D}from"./app-Biwwp5Hz.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-BpFKrCT-.js";const Z={name:"AddCustomer",components:{AppLayout:K,Multiselect:R,Link:Y},props:{packages:Object,townships:Object,projects:Object,status_list:Object,subcoms:Object,dn:Object,pops:Object,max_id:Array,errors:Object,user:Object,bundle_equiptments:Object,partners:Object,isps:Object,userPerm:Array},setup(n){let t=u(""),g=u(""),o=u(!1);const O=u(null),w=u([]),b=u([]),x=u([]),s=H({id:null,name:"",phone_1:"",address:"",latitude:"",longitude:"",order_date:"",installation_date:"",ftth_id:"",package:"",status:"",subcom:"",township:"",prefer_install_date:"",pop_id:"",dn_id:"",sn_id:"",splitter_no:"",installation_remark:"",fc_used:"",fc_damaged:"",onu_serial:"",onu_power:"",fiber_distance:"",vlan:"",bundles:"",pop_device_id:"",gpon_ontid:"",port_balance:"",order_remark:"",partner_id:"",created_by:"",isp_id:""});function h(){s.reset()}const a=u(Array.from({length:16},(r,d)=>({id:d+1,name:`SN Port ${d+1}`}))),C=u(Array.from({length:127},(r,d)=>({id:d,name:`OnuID${d}`})));function I(){s._method="POST",J.post("/customer",s,{preserveState:!0,onSuccess:r=>{console.log("success.. "),Toast.fire({icon:"success",title:r.props.flash.message})},onError:r=>{console.log("error ..".errors)}})}function U(r){r=r||window.event;var d=r.which?r.which:r.keyCode;if(d>31&&(d<48||d>57)&&d!==46)r.preventDefault();else return!0}function A(r){var i;const d=(i=n.user)==null?void 0:i.role;return d&&d!=null&&d.read_customer?!0:!n.userPerm.includes(r)}function F(){let r=s.township.city_code,d=s.township.city_id;var i=n.max_id.filter(_=>_.id==d)[0];s.ftth_id=r+("000000"+(parseInt(i.value)+1)).slice(-6)+"FX"}function T(){s.pppoe_account||s.ftth_id&&s.township&&(s.pppoe_account=s.ftth_id,o.value=!0)}function B(r){r=r.replace(/\(.*?\)/g,"").trim();const d=r.split(/\s+/);let i="";for(let y=0;y<d.length&&(i+=d[y][0].toUpperCase(),i.length!==3);y++);const _=new Date().getFullYear();return i.padEnd(3,i[i.length-1]||"")+"@"+_+"FIP"}function q(){s.pppoe_password||s.ftth_id&&s.name&&s.pppoe_account&&(s.pppoe_password=B(s.name))}function z(r){return Array.isArray(r)?(console.log("array"),r.length===0?(console.log("empty array"),!0):r.every(d=>typeof d=="object"&&Object.keys(d).length===0)):r&&typeof r=="object"?Object.keys(r).length===0:!1}const L=async()=>{if(!s.pop_id){w.value=[];return}try{const d=await(await fetch(`/getOLTByPOP/${s.pop_id.id}`)).json();w.value=d||[]}catch(r){console.error("Failed to fetch POP devices",r)}},M=async()=>{if(!s.pop_device_id){b.value=[];return}try{const d=await(await fetch(`/getDNByOLT/${s.pop_device_id.id}`)).json();b.value=d||[]}catch(r){console.error("Failed to fetch DNs",r)}},E=async()=>{if(!s.dn_id){x.value=[];return}try{const d=await(await fetch(`/getDnId/${s.dn_id.id}`)).json();x.value=d||[]}catch(r){console.error("Failed to fetch SNs",r)}},k=u([]);return v(()=>s.township,async r=>{var d;if(r&&((d=n.user)==null?void 0:d.user_type)=="internal")try{s.pop_id=null,s.pop_device_id=null,s.dn_id=null,s.sn_id=null,r.partner_id&&(s.partner=n.partners.find(y=>y.id===r.partner_id));const _=await(await fetch(`/getPOPsByTownship/${r.id}`)).json();k.value=_||[]}catch(i){console.error("Failed to fetch POPs for township",i),k.value=[]}else k.value=[],s.partner=null}),v(()=>s.pop_id,()=>{L(),s.sn_id=null,s.dn_id=null,s.pop_device_id=null,s.gpon_frame=null,s.gpon_slot=null,s.gpon_port=null,s.gpon_ontid=null,s.port_balance=null}),v(()=>s.pop_device_id,()=>{M(),s.dn_id=null,s.sn_id=null}),v(()=>s.dn_id,()=>{E(),O.value=`Frame${s.dn_id.gpon_frame}/Slot${s.dn_id.gpon_slot}/Port${s.dn_id.gpon_port}`,s.sn_id=null}),X(()=>{s.status=n.status_list[0]}),{form:s,submit:I,resetForm:h,isNumber:U,checkPerm:A,goID:F,fillPppoe:T,pppoe_auto:o,generatePassword:q,res_packages:g,isEmptyObject:z,pop_devices:t,snPortNoOptions:a,gponOnuIdOptions:C,dnInfo:O,popDevices:w,dnOptions:b,snOptions:x,filteredPops:k}}},$={class:"py-2"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"mt-5 md:mt-0"},se={class:"shadow sm:rounded-md sm:overflow-hidden"},oe={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},re={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},ne={class:"col-span-1 sm:col-span-1"},de={class:"mt-1 flex rounded-md shadow-sm"},ae=["disabled"],le={class:"col-span-1 sm:col-span-1"},ie={key:0,class:"mt-1 flex rounded-md shadow-sm"},me={class:"col-span-1 sm:col-span-2"},pe={class:"mt-1 flex rounded-md shadow-sm"},ue=["disabled"],ce={class:"col-span-1 sm:col-span-1"},fe={class:"mt-1 flex rounded-md shadow-sm"},ge=["disabled"],be={class:"col-span-1 sm:col-span-1"},xe={class:"mt-1 flex rounded-md shadow-sm"},_e=["disabled"],ye={class:"col-span-1 sm:col-span-2"},we={class:"mt-1 flex rounded-md shadow-sm"},he=["disabled"],ke={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},ve={class:"col-span-1 sm:col-span-1 w-full"},Pe={class:"mt-1 flex rounded-md shadow-sm"},je=["disabled"],Oe={class:"col-span-1 sm:col-span-1"},Ve={class:"mt-1 flex rounded-md shadow-sm"},Se=["min","disabled"],Ne={class:"col-span-1 sm:col-span-1"},De={key:0,class:"mt-1 flex rounded-md shadow-sm"},Ce={class:"col-span-1 sm:col-span-1"},Ie={class:"mt-1 p-2 space-x-2 inline-flex"},Ue={class:"col-span-1 sm:col-span-1"},Ae={class:"mt-1 flex rounded-md shadow-sm"},Fe=["min","disabled"],Te={class:"col-span-1 sm:col-span-1"},Be={key:0,class:"mt-1 flex rounded-md shadow-sm"},qe={class:"col-span-1 sm:col-span-2"},ze={class:"mt-1 flex rounded-md shadow-sm"},Le=["disabled"],Me={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"};function Ee(n,t,g,o,O,w){const b=V("multiselect"),x=V("Link"),s=V("app-layout");return P(),G(s,null,{header:S(()=>t[16]||(t[16]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"},"Customer Details",-1)])),default:S(()=>{var h;return[e("div",$,[e("div",ee,[e("div",te,[e("form",{onSubmit:t[15]||(t[15]=Q((...a)=>o.submit&&o.submit(...a),["prevent"]))},[e("div",se,[e("div",oe,[t[38]||(t[38]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Customer Basic Information",-1)),e("div",re,[e("div",ne,[t[18]||(t[18]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Name ")],-1)),e("div",de,[t[17]||(t[17]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.form.name=a),name:"name",id:"name",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Customer Name",required:"",disabled:o.checkPerm("name")},null,8,ae),[[f,o.form.name]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.name),513),[[p,n.$page.props.errors.name]])]),e("div",le,[t[19]||(t[19]=e("label",{for:"township",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Township ")],-1)),g.townships.length!==0?(P(),N("div",ie,[j(b,{"deselect-label":"Selected already",options:g.townships,"track-by":"id",label:"name",modelValue:o.form.township,"onUpdate:modelValue":t[1]||(t[1]=a=>o.form.township=a),placeholder:"Select Township","allow-empty":!1,disabled:o.checkPerm("township_id"),required:""},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.township_id),513),[[p,n.$page.props.errors.township_id]])]),e("div",me,[t[21]||(t[21]=e("label",{for:"phone_1",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Phone No. (e.g. 09-123/09-456)")],-1)),e("div",pe,[t[20]||(t[20]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-phone"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>o.form.phone_1=a),name:"phone_1",id:"phone_1",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"e.g 0945000111",required:"",disabled:o.checkPerm("phone_1")},null,8,ue),[[f,o.form.phone_1]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.phone_1),513),[[p,n.$page.props.errors.phone_1]])]),e("div",ce,[t[23]||(t[23]=e("label",{for:"latitude",class:"block text-sm font-medium text-gray-700"},"Latitude ",-1)),e("div",fe,[t[22]||(t[22]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=a=>o.form.latitude=a),name:"latitude",id:"latitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:t[4]||(t[4]=a=>o.isNumber(n.event)),disabled:o.checkPerm("location")},null,40,ge),[[f,o.form.latitude]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.latitude),513),[[p,n.$page.props.errors.latitude]])]),e("div",be,[t[25]||(t[25]=e("label",{for:"longitude",class:"block text-sm font-medium text-gray-700"},"Longitude ",-1)),e("div",xe,[t[24]||(t[24]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=a=>o.form.longitude=a),name:"longitude",id:"longitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:t[6]||(t[6]=a=>o.isNumber(n.event)),disabled:o.checkPerm("location")},null,40,_e),[[f,o.form.longitude]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.longitude),513),[[p,n.$page.props.errors.longitude]])]),e("div",ye,[t[27]||(t[27]=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Full Address ")],-1)),e("div",we,[t[26]||(t[26]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-map-marker-alt"})],-1)),l(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>o.form.address=a),name:"address",id:"address",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("address")},null,8,he),[[f,o.form.address]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.address),513),[[p,n.$page.props.errors.address]])])]),t[39]||(t[39]=e("hr",{class:"my-4 md:min-w-full"},null,-1)),t[40]||(t[40]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Order Information",-1)),e("div",ke,[e("div",ve,[t[29]||(t[29]=e("label",{for:"ftth_id",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer ID ")],-1)),e("div",Pe,[t[28]||(t[28]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-id-badge"})],-1)),l(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>o.form.ftth_id=a),type:"text",name:"ftth_id",id:"ftth_id",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("ftth_id")},null,8,je),[[f,o.form.ftth_id]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.ftth_id),513),[[p,n.$page.props.errors.ftth_id]])]),e("div",Oe,[t[30]||(t[30]=e("label",{for:"order_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Order Date ")],-1)),e("div",Ve,[l(e("input",{type:"date","onUpdate:modelValue":t[9]||(t[9]=a=>o.form.order_date=a),name:"order_date",id:"order_date",min:new Date().toISOString().split("T")[0],class:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("order_date")},null,8,Se),[[f,o.form.order_date]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.order_date),513),[[p,n.$page.props.errors.order_date]])]),e("div",Ne,[t[31]||(t[31]=e("label",{for:"package",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Package ")],-1)),g.packages?(P(),N("div",De,[j(b,{"deselect-label":"Selected already",options:g.packages,"track-by":"id",label:"name",modelValue:o.form.package,"onUpdate:modelValue":t[10]||(t[10]=a=>o.form.package=a),"allow-empty":!1,disabled:o.checkPerm("package_id")},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.package),513),[[p,n.$page.props.errors.package]])]),e("div",Ce,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700"}," Installation Timeline ",-1)),e("div",Ie,m((h=o.form.package)==null?void 0:h.installation_timeline)+" "+m(o.form.package?" Hours":""),1)]),e("div",Ue,[t[34]||(t[34]=e("label",{for:"prefer_install_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Prefer Installation Date ")],-1)),e("div",Ae,[t[33]||(t[33]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-tools"})],-1)),l(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>o.form.prefer_install_date=a),type:"date",name:"prefer_install_date",id:"prefer_install_date",min:new Date().toISOString().split("T")[0],class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:o.checkPerm("prefer_install_date")},null,8,Fe),[[f,o.form.prefer_install_date]])])]),e("div",Te,[t[35]||(t[35]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Status ")],-1)),g.status_list.length!==0?(P(),N("div",Be,[j(b,{"deselect-label":"Selected already",options:g.status_list,"track-by":"id",label:"name",modelValue:o.form.status,"onUpdate:modelValue":t[12]||(t[12]=a=>o.form.status=a),"allow-empty":!1,disabled:o.checkPerm("status_id")},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.status),513),[[p,n.$page.props.errors.status]])]),e("div",qe,[t[37]||(t[37]=e("label",{for:"order_remark",class:"block text-sm font-medium text-gray-700"}," Order Remark ",-1)),e("div",ze,[t[36]||(t[36]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-comment"})],-1)),l(e("textarea",{name:"order_remark","onUpdate:modelValue":t[13]||(t[13]=a=>o.form.order_remark=a),id:"order_remark",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:o.checkPerm("order_remark")},null,8,Le),[[f,o.form.order_remark]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.order_remark),513),[[p,n.$page.props.errors.order_remark]])])])]),e("div",Me,[j(x,{href:n.route("customer.index"),class:"inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},{default:S(()=>t[41]||(t[41]=[c("Back")])),_:1},8,["href"]),e("button",{onClick:t[14]||(t[14]=(...a)=>o.resetForm&&o.resetForm(...a)),type:"button",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gray-600 hover:bg-gray-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},"Reset"),t[42]||(t[42]=e("button",{"wire:click.prevent":"submit",type:"submit",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Save",-1))])])],32)])])])]}),_:1})}const Ge=W(Z,[["render",Ee]]);export{Ge as default};
