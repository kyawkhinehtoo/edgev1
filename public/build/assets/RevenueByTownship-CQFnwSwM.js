import{A as R}from"./AppLayout-ldcU5hlp.js";import{r as h,T as C,q as j,z as D,c as E,w as _,M as F,o as n,a as e,f as a,t as d,d as i,j as m,v as b,F as u,g as f,n as S}from"./app-D4kHwI1v.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-XYJmGyPC.js";const L={name:"RevenueByTownship",components:{AppLayout:R},props:{city_list:Object,errors:Object},setup(k){const t=h([]),x=h([]),s=C({city_id:"",year:new Date().getFullYear(),revenue_type:"all"}),v=j(()=>{const r=new Date().getFullYear(),c=[];for(let l=r;l>=r-5;l--)c.push(l);return c}),w=()=>{s.post("/revenue-by-township",{onSuccess:r=>{console.log("Success response:",r),r.props&&r.props.revenueData&&(t.value=r.props.revenueData,x.value=r.props.townships||[],console.log("Revenue data set:",t.value),console.log("Townships set:",x.value))},onError:r=>{console.log("Errors:",r)}})},g=()=>{F.post("/revenue-by-township/export",s.data(),{responseType:"blob"}).then(r=>{const c=new Blob([r.data],{type:r.headers["content-type"]}),l=document.createElement("a");l.href=window.URL.createObjectURL(c),l.download=`revenue_by_township_${s.year}_${new Date().getTime()}.xlsx`,l.click()}).catch(r=>{console.error("Export failed:",r)})},o=r=>!r||r===0?"0":parseInt(r).toLocaleString("en-US"),y=(r,c)=>{const l=r.townships.find(T=>T.township_id===c);return l?l.revenue:0};return{form:s,revenueData:t,townships:x,yearOptions:v,generateReport:w,exportExcel:g,formatCurrency:o,getRevenueForTownship:y,getTownshipTotal:r=>t.value.reduce((c,l)=>c+y(l,r),0),getGrandTotal:()=>t.value.reduce((r,c)=>r+(c.total||0),0)}}},O={class:"flex items-center justify-between"},G={class:"text-sm text-blue-200"},U={class:"py-4 bg-gray-50 min-h-screen"},z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},A={class:"bg-white shadow-lg rounded-lg border border-gray-200"},V={class:"p-4"},N={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Y={class:"space-y-1"},M={key:0,class:"relative"},I=["value"],q={key:1,class:"text-xs text-gray-500 italic"},H={class:"space-y-1"},J={class:"relative"},K=["value"],P={class:"space-y-1"},Q={class:"relative"},W={class:"space-y-1 flex items-end"},X={class:"flex gap-2 w-full"},Z={class:"mt-4"},$={key:0,class:"bg-white shadow rounded-md border border-gray-200 overflow-hidden"},ee={class:"px-4 py-2 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100"},te={class:"flex items-center justify-between"},se={class:"text-sm font-medium text-gray-900 flex items-center"},oe={class:"text-xs text-gray-600"},re={class:"overflow-x-auto"},ne={class:"min-w-full divide-y divide-gray-200"},ie={class:"bg-gray-50"},ae={class:"bg-white divide-y divide-gray-200"},le={class:"px-3 py-2 whitespace-nowrap sticky left-0 bg-inherit z-10 border-r border-gray-200"},de={class:"text-xs font-medium text-gray-900"},ce={class:"text-xs font-semibold text-gray-900"},xe={class:"px-3 py-2 whitespace-nowrap text-center bg-yellow-50 border-l border-gray-200"},ue={class:"text-xs font-bold text-gray-900"},fe={class:"bg-yellow-100 border-t-2 border-yellow-300"},ye={class:"text-xs font-bold text-gray-900"},ge={class:"px-3 py-2 whitespace-nowrap text-center bg-yellow-200 border-l border-yellow-300"},pe={class:"text-xs font-bold text-red-600"},me={key:1,class:"bg-white shadow rounded-md border border-gray-200 p-8 text-center"};function be(k,t,x,s,v,w){const g=D("app-layout");return n(),E(g,null,{header:_(()=>[e("div",O,[t[7]||(t[7]=e("h2",{class:"font-semibold text-xl text-white leading-tight flex items-center"},[e("i",{class:"fas fa-chart-bar mr-3 text-blue-200"}),a(" Revenue by Township Report ")],-1)),e("div",G,[t[6]||(t[6]=e("i",{class:"fas fa-calendar-alt mr-1"},null,-1)),a(" "+d(new Date().toLocaleDateString()),1)])])]),default:_(()=>[e("div",U,[e("div",z,[t[24]||(t[24]=e("div",{class:"mb-4"},[e("h3",{class:"text-base font-semibold text-gray-900 flex items-center"},[e("i",{class:"fas fa-filter mr-2 text-indigo-600"}),a(" Report Filters ")]),e("p",{class:"mt-1 text-xs text-gray-600"},"Filter revenue data by city and year")],-1)),e("div",A,[t[15]||(t[15]=e("div",{class:"px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-blue-50"},[e("h4",{class:"text-sm font-medium text-gray-900 flex items-center"},[e("i",{class:"fas fa-search mr-2 text-indigo-600"}),a(" Filter Criteria ")])],-1)),e("div",V,[e("div",N,[e("div",Y,[t[9]||(t[9]=e("label",{for:"city_id",class:"text-xs font-medium text-gray-700 flex items-center"},[e("i",{class:"fas fa-city mr-1 text-gray-500 text-xs"}),a(" City ")],-1)),x.city_list.length!==0?(n(),i("div",M,[m(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.form.city_id=o),name:"city_id",id:"city_id",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200 bg-white text-sm form-input focus-ring"},[t[8]||(t[8]=e("option",{value:""},"All Cities",-1)),(n(!0),i(u,null,f(x.city_list,o=>(n(),i("option",{key:o.id,value:o.id},d(o.name),9,I))),128))],512),[[b,s.form.city_id]])])):(n(),i("div",q,"No cities available"))]),e("div",H,[t[10]||(t[10]=e("label",{for:"year",class:"text-xs font-medium text-gray-700 flex items-center"},[e("i",{class:"fas fa-calendar mr-1 text-gray-500 text-xs"}),a(" Year ")],-1)),e("div",J,[m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.form.year=o),name:"year",id:"year",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200 bg-white text-sm form-input focus-ring"},[(n(!0),i(u,null,f(s.yearOptions,o=>(n(),i("option",{key:o,value:o},d(o),9,K))),128))],512),[[b,s.form.year]])])]),e("div",P,[t[12]||(t[12]=e("label",{for:"revenue_type",class:"text-xs font-medium text-gray-700 flex items-center"},[e("i",{class:"fas fa-money-bill-wave mr-1 text-gray-500 text-xs"}),a(" Revenue Type ")],-1)),e("div",Q,[m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.form.revenue_type=o),name:"revenue_type",id:"revenue_type",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200 bg-white text-sm form-input focus-ring"},t[11]||(t[11]=[e("option",{value:"all"},"All Revenue",-1),e("option",{value:"receivables"},"Receivables Only",-1)]),512),[[b,s.form.revenue_type]])])]),e("div",W,[e("div",X,[e("button",{onClick:t[3]||(t[3]=(...o)=>s.generateReport&&s.generateReport(...o)),type:"button",class:"flex-1 inline-flex items-center justify-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-indigo-500 shadow-sm btn-hover-scale text-sm"},t[13]||(t[13]=[e("i",{class:"fas fa-chart-bar mr-1 text-xs"},null,-1),a(" Generate ")])),e("button",{onClick:t[4]||(t[4]=(...o)=>s.exportExcel&&s.exportExcel(...o)),type:"button",class:"flex-1 inline-flex items-center justify-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-green-500 shadow-sm btn-hover-scale text-sm"},t[14]||(t[14]=[e("i",{class:"fas fa-download mr-1 text-xs"},null,-1),a(" Export ")]))])])])])]),e("div",Z,[s.revenueData&&s.revenueData.length>0?(n(),i("div",$,[e("div",ee,[e("div",te,[e("h4",se,[t[16]||(t[16]=e("i",{class:"fas fa-table mr-1 text-gray-600 text-xs"},null,-1)),a(" "+d(s.form.revenue_type==="receivables"?"Receivables":"Revenue")+" by Township - "+d(s.form.year),1)]),e("div",oe,d(s.townships.length)+" townships ",1)])]),e("div",re,[e("table",ne,[e("thead",ie,[e("tr",null,[t[17]||(t[17]=e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider sticky left-0 bg-gray-50 z-10"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-calendar mr-1 text-xs"}),a(" Month ")])],-1)),(n(!0),i(u,null,f(s.townships,o=>(n(),i("th",{key:o.id,scope:"col",class:"px-3 py-2 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider min-w-[100px]"},d(o.short_code),1))),128)),t[18]||(t[18]=e("th",{scope:"col",class:"px-3 py-2 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider bg-yellow-50 min-w-[100px]"},[e("div",{class:"flex items-center justify-center"},[e("i",{class:"fas fa-calculator mr-1 text-xs"}),a(" Total ")])],-1))])]),e("tbody",ae,[(n(!0),i(u,null,f(s.revenueData,(o,y)=>(n(),i("tr",{key:o.month,class:S([y%2===0?"bg-white":"bg-gray-50","hover:bg-indigo-50 transition-colors duration-150"])},[e("td",le,[e("div",de,d(o.month),1)]),(n(!0),i(u,null,f(s.townships,p=>(n(),i("td",{key:p.id,class:"px-3 py-2 whitespace-nowrap text-center"},[e("div",ce,d(s.formatCurrency(s.getRevenueForTownship(o,p.id))),1)]))),128)),e("td",xe,[e("div",ue,d(s.formatCurrency(o.total)),1)])],2))),128)),e("tr",fe,[t[19]||(t[19]=e("td",{class:"px-3 py-2 whitespace-nowrap sticky left-0 bg-yellow-100 z-10 border-r border-yellow-300"},[e("div",{class:"text-xs font-bold text-gray-900"},"TOTAL")],-1)),(n(!0),i(u,null,f(s.townships,o=>(n(),i("td",{key:"total-"+o.id,class:"px-3 py-2 whitespace-nowrap text-center"},[e("div",ye,d(s.formatCurrency(s.getTownshipTotal(o.id))),1)]))),128)),e("td",ge,[e("div",pe,d(s.formatCurrency(s.getGrandTotal())),1)])])])])])])):(n(),i("div",me,[t[21]||(t[21]=e("div",{class:"w-12 h-12 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-3"},[e("i",{class:"fas fa-chart-bar text-gray-400 text-lg"})],-1)),t[22]||(t[22]=e("h3",{class:"text-base font-medium text-gray-900 mb-2"},"No revenue data found",-1)),t[23]||(t[23]=e("p",{class:"text-gray-600 mb-4 text-sm"},"Select a city and year, then click Generate to view revenue data.",-1)),e("button",{onClick:t[5]||(t[5]=(...o)=>s.generateReport&&s.generateReport(...o)),class:"inline-flex items-center px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-md transition-colors duration-200 text-sm"},t[20]||(t[20]=[e("i",{class:"fas fa-chart-bar mr-1 text-xs"},null,-1),a(" Generate Report ")]))]))])])])]),_:1})}const Te=B(L,[["render",be],["__scopeId","data-v-dab86a08"]]);export{Te as default};
