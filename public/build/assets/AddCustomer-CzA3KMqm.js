import{A as K}from"./AppLayout-AWvXsef1.js";import{M as R}from"./vue3-multiselect.umd.min-BafU7pYL.js";import{i as Y,r as u,T as H,m as v,p as X,q as V,c as G,w as S,N as J,o as P,a as e,h as Q,f as c,s as l,v as f,x as p,t as m,d as N,b as j,e as D}from"./app-1_OvV86E.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-D37ArPI-.js";const Z={name:"AddCustomer",components:{AppLayout:K,Multiselect:R,Link:Y},props:{packages:Object,townships:Object,projects:Object,status_list:Object,subcoms:Object,dn:Object,pops:Object,max_id:Array,errors:Object,user:Object,bundle_equiptments:Object,partners:Object,isps:Object,userPerm:Array},setup(n){let s=u(""),g=u(""),o=u(!1);const O=u(null),w=u([]),b=u([]),_=u([]),t=H({id:null,name:"",phone_1:"",address:"",latitude:"",longitude:"",order_date:"",installation_date:"",isp_ftth_id:"",package:"",status:"",subcom:"",township:"",prefer_install_date:"",pop_id:"",dn_id:"",sn_id:"",splitter_no:"",installation_remark:"",fc_used:"",fc_damaged:"",onu_serial:"",onu_power:"",fiber_distance:"",vlan:"",bundles:"",pop_device_id:"",gpon_ontid:"",port_balance:"",order_remark:"",partner_id:"",created_by:"",isp_id:""});function h(){t.reset()}const a=u(Array.from({length:16},(r,d)=>({id:d+1,name:`SN Port ${d+1}`}))),C=u(Array.from({length:127},(r,d)=>({id:d,name:`OnuID${d}`})));function I(){t._method="POST",J.post("/customer",t,{preserveState:!0,onSuccess:r=>{console.log("success.. "),Toast.fire({icon:"success",title:r.props.flash.message})},onError:r=>{console.log("error ..".errors)}})}function U(r){r=r||window.event;var d=r.which?r.which:r.keyCode;if(d>31&&(d<48||d>57)&&d!==46)r.preventDefault();else return!0}function A(r){var i;const d=(i=n.user)==null?void 0:i.role;return d&&d!=null&&d.read_customer?!0:!n.userPerm.includes(r)}function F(){let r=t.township.city_code,d=t.township.city_id;var i=n.max_id.filter(x=>x.id==d)[0];t.isp_ftth_id=r+("000000"+(parseInt(i.value)+1)).slice(-6)+"FX"}function T(){t.pppoe_account||t.isp_ftth_id&&t.township&&(t.pppoe_account=t.isp_ftth_id,o.value=!0)}function B(r){r=r.replace(/\(.*?\)/g,"").trim();const d=r.split(/\s+/);let i="";for(let y=0;y<d.length&&(i+=d[y][0].toUpperCase(),i.length!==3);y++);const x=new Date().getFullYear();return i.padEnd(3,i[i.length-1]||"")+"@"+x+"FIP"}function q(){t.pppoe_password||t.isp_ftth_id&&t.name&&t.pppoe_account&&(t.pppoe_password=B(t.name))}function z(r){return Array.isArray(r)?(console.log("array"),r.length===0?(console.log("empty array"),!0):r.every(d=>typeof d=="object"&&Object.keys(d).length===0)):r&&typeof r=="object"?Object.keys(r).length===0:!1}const L=async()=>{if(!t.pop_id){w.value=[];return}try{const d=await(await fetch(`/getOLTByPOP/${t.pop_id.id}`)).json();w.value=d||[]}catch(r){console.error("Failed to fetch POP devices",r)}},M=async()=>{if(!t.pop_device_id){b.value=[];return}try{const d=await(await fetch(`/getDNByOLT/${t.pop_device_id.id}`)).json();b.value=d||[]}catch(r){console.error("Failed to fetch DNs",r)}},E=async()=>{if(!t.dn_id){_.value=[];return}try{const d=await(await fetch(`/getDnId/${t.dn_id.id}`)).json();_.value=d||[]}catch(r){console.error("Failed to fetch SNs",r)}},k=u([]);return v(()=>t.township,async r=>{var d;if(r&&((d=n.user)==null?void 0:d.user_type)=="internal")try{t.pop_id=null,t.pop_device_id=null,t.dn_id=null,t.sn_id=null,r.partner_id&&(t.partner=n.partners.find(y=>y.id===r.partner_id));const x=await(await fetch(`/getPOPsByTownship/${r.id}`)).json();k.value=x||[]}catch(i){console.error("Failed to fetch POPs for township",i),k.value=[]}else k.value=[],t.partner=null}),v(()=>t.pop_id,()=>{L(),t.sn_id=null,t.dn_id=null,t.pop_device_id=null,t.gpon_frame=null,t.gpon_slot=null,t.gpon_port=null,t.gpon_ontid=null,t.port_balance=null}),v(()=>t.pop_device_id,()=>{M(),t.dn_id=null,t.sn_id=null}),v(()=>t.dn_id,()=>{E(),O.value=`Frame${t.dn_id.gpon_frame}/Slot${t.dn_id.gpon_slot}/Port${t.dn_id.gpon_port}`,t.sn_id=null}),X(()=>{t.status=n.status_list[0]}),{form:t,submit:I,resetForm:h,isNumber:U,checkPerm:A,goID:F,fillPppoe:T,pppoe_auto:o,generatePassword:q,res_packages:g,isEmptyObject:z,pop_devices:s,snPortNoOptions:a,gponOnuIdOptions:C,dnInfo:O,popDevices:w,dnOptions:b,snOptions:_,filteredPops:k}}},$={class:"py-2"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},se={class:"mt-5 md:mt-0"},te={class:"shadow sm:rounded-md sm:overflow-hidden"},oe={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},re={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},ne={class:"col-span-1 sm:col-span-1"},de={class:"mt-1 flex rounded-md shadow-sm"},ae=["disabled"],le={class:"col-span-1 sm:col-span-1"},ie={key:0,class:"mt-1 flex rounded-md shadow-sm"},me={class:"col-span-1 sm:col-span-2"},pe={class:"mt-1 flex rounded-md shadow-sm"},ue=["disabled"],ce={class:"col-span-1 sm:col-span-1"},fe={class:"mt-1 flex rounded-md shadow-sm"},ge=["disabled"],be={class:"col-span-1 sm:col-span-1"},_e={class:"mt-1 flex rounded-md shadow-sm"},xe=["disabled"],ye={class:"col-span-1 sm:col-span-2"},we={class:"mt-1 flex rounded-md shadow-sm"},he=["disabled"],ke={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},ve={class:"col-span-1 sm:col-span-1 w-full"},Pe={class:"mt-1 flex rounded-md shadow-sm"},je=["disabled"],Oe={class:"col-span-1 sm:col-span-1"},Ve={class:"mt-1 flex rounded-md shadow-sm"},Se=["min","disabled"],Ne={class:"col-span-1 sm:col-span-1"},De={key:0,class:"mt-1 flex rounded-md shadow-sm"},Ce={class:"col-span-1 sm:col-span-1"},Ie={class:"mt-1 p-2 space-x-2 inline-flex"},Ue={class:"col-span-1 sm:col-span-1"},Ae={class:"mt-1 flex rounded-md shadow-sm"},Fe=["min","disabled"],Te={class:"col-span-1 sm:col-span-1"},Be={key:0,class:"mt-1 flex rounded-md shadow-sm"},qe={class:"col-span-1 sm:col-span-2"},ze={class:"mt-1 flex rounded-md shadow-sm"},Le=["disabled"],Me={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"};function Ee(n,s,g,o,O,w){const b=V("multiselect"),_=V("Link"),t=V("app-layout");return P(),G(t,null,{header:S(()=>s[16]||(s[16]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"},"Customer Details",-1)])),default:S(()=>{var h;return[e("div",$,[e("div",ee,[e("div",se,[e("form",{onSubmit:s[15]||(s[15]=Q((...a)=>o.submit&&o.submit(...a),["prevent"]))},[e("div",te,[e("div",oe,[s[38]||(s[38]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Customer Basic Information",-1)),e("div",re,[e("div",ne,[s[18]||(s[18]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Name ")],-1)),e("div",de,[s[17]||(s[17]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>o.form.name=a),name:"name",id:"name",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Customer Name",required:"",disabled:o.checkPerm("name")},null,8,ae),[[f,o.form.name]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.name),513),[[p,n.$page.props.errors.name]])]),e("div",le,[s[19]||(s[19]=e("label",{for:"township",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Township ")],-1)),g.townships.length!==0?(P(),N("div",ie,[j(b,{"deselect-label":"Selected already",options:g.townships,"track-by":"id",label:"name",modelValue:o.form.township,"onUpdate:modelValue":s[1]||(s[1]=a=>o.form.township=a),placeholder:"Select Township","allow-empty":!1,disabled:o.checkPerm("township_id"),required:""},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.township_id),513),[[p,n.$page.props.errors.township_id]])]),e("div",me,[s[21]||(s[21]=e("label",{for:"phone_1",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Phone No. (e.g. 09-123/09-456)")],-1)),e("div",pe,[s[20]||(s[20]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-phone"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=a=>o.form.phone_1=a),name:"phone_1",id:"phone_1",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"e.g 0945000111",required:"",disabled:o.checkPerm("phone_1")},null,8,ue),[[f,o.form.phone_1]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.phone_1),513),[[p,n.$page.props.errors.phone_1]])]),e("div",ce,[s[23]||(s[23]=e("label",{for:"latitude",class:"block text-sm font-medium text-gray-700"},"Latitude ",-1)),e("div",fe,[s[22]||(s[22]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=a=>o.form.latitude=a),name:"latitude",id:"latitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:s[4]||(s[4]=a=>o.isNumber(n.event)),disabled:o.checkPerm("location")},null,40,ge),[[f,o.form.latitude]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.latitude),513),[[p,n.$page.props.errors.latitude]])]),e("div",be,[s[25]||(s[25]=e("label",{for:"longitude",class:"block text-sm font-medium text-gray-700"},"Longitude ",-1)),e("div",_e,[s[24]||(s[24]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),l(e("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=a=>o.form.longitude=a),name:"longitude",id:"longitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:s[6]||(s[6]=a=>o.isNumber(n.event)),disabled:o.checkPerm("location")},null,40,xe),[[f,o.form.longitude]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.longitude),513),[[p,n.$page.props.errors.longitude]])]),e("div",ye,[s[27]||(s[27]=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Full Address ")],-1)),e("div",we,[s[26]||(s[26]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-map-marker-alt"})],-1)),l(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=a=>o.form.address=a),name:"address",id:"address",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("address")},null,8,he),[[f,o.form.address]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.address),513),[[p,n.$page.props.errors.address]])])]),s[39]||(s[39]=e("hr",{class:"my-4 md:min-w-full"},null,-1)),s[40]||(s[40]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Order Information",-1)),e("div",ke,[e("div",ve,[s[29]||(s[29]=e("label",{for:"isp_ftth_id",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer ID ")],-1)),e("div",Pe,[s[28]||(s[28]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-id-badge"})],-1)),l(e("input",{"onUpdate:modelValue":s[8]||(s[8]=a=>o.form.isp_ftth_id=a),type:"text",name:"isp_ftth_id",id:"isp_ftth_id",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("isp_ftth_id")},null,8,je),[[f,o.form.isp_ftth_id]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.isp_ftth_id),513),[[p,n.$page.props.errors.isp_ftth_id]])]),e("div",Oe,[s[30]||(s[30]=e("label",{for:"order_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Order Date ")],-1)),e("div",Ve,[l(e("input",{type:"date","onUpdate:modelValue":s[9]||(s[9]=a=>o.form.order_date=a),name:"order_date",id:"order_date",min:new Date().toISOString().split("T")[0],class:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:o.checkPerm("order_date")},null,8,Se),[[f,o.form.order_date]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.order_date),513),[[p,n.$page.props.errors.order_date]])]),e("div",Ne,[s[31]||(s[31]=e("label",{for:"package",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Package ")],-1)),g.packages?(P(),N("div",De,[j(b,{"deselect-label":"Selected already",options:g.packages,"track-by":"id",label:"name",modelValue:o.form.package,"onUpdate:modelValue":s[10]||(s[10]=a=>o.form.package=a),"allow-empty":!1,disabled:o.checkPerm("package_id")},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.package),513),[[p,n.$page.props.errors.package]])]),e("div",Ce,[s[32]||(s[32]=e("label",{class:"block text-sm font-medium text-gray-700"}," Installation Timeline ",-1)),e("div",Ie,m((h=o.form.package)==null?void 0:h.installation_timeline)+" "+m(o.form.package?" Hours":""),1)]),e("div",Ue,[s[34]||(s[34]=e("label",{for:"prefer_install_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Prefer Installation Date ")],-1)),e("div",Ae,[s[33]||(s[33]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-tools"})],-1)),l(e("input",{"onUpdate:modelValue":s[11]||(s[11]=a=>o.form.prefer_install_date=a),type:"date",name:"prefer_install_date",id:"prefer_install_date",min:new Date().toISOString().split("T")[0],class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:o.checkPerm("prefer_install_date")},null,8,Fe),[[f,o.form.prefer_install_date]])])]),e("div",Te,[s[35]||(s[35]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Status ")],-1)),g.status_list.length!==0?(P(),N("div",Be,[j(b,{"deselect-label":"Selected already",options:g.status_list,"track-by":"id",label:"name",modelValue:o.form.status,"onUpdate:modelValue":s[12]||(s[12]=a=>o.form.status=a),"allow-empty":!1,disabled:o.checkPerm("status_id")},null,8,["options","modelValue","disabled"])])):D("",!0),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.status),513),[[p,n.$page.props.errors.status]])]),e("div",qe,[s[37]||(s[37]=e("label",{for:"order_remark",class:"block text-sm font-medium text-gray-700"}," Order Remark ",-1)),e("div",ze,[s[36]||(s[36]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-comment"})],-1)),l(e("textarea",{name:"order_remark","onUpdate:modelValue":s[13]||(s[13]=a=>o.form.order_remark=a),id:"order_remark",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:o.checkPerm("order_remark")},null,8,Le),[[f,o.form.order_remark]])]),l(e("p",{class:"mt-2 text-sm text-red-500"},m(n.$page.props.errors.order_remark),513),[[p,n.$page.props.errors.order_remark]])])])]),e("div",Me,[j(_,{href:n.route("customer.index"),class:"inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},{default:S(()=>s[41]||(s[41]=[c("Back")])),_:1},8,["href"]),e("button",{onClick:s[14]||(s[14]=(...a)=>o.resetForm&&o.resetForm(...a)),type:"button",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gray-600 hover:bg-gray-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},"Reset"),s[42]||(s[42]=e("button",{"wire:click.prevent":"submit",type:"submit",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Save",-1))])])],32)])])])]}),_:1})}const Ge=W(Z,[["render",Ee]]);export{Ge as default};
