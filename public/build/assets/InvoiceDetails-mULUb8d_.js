import{E as D,q as g,c as T,w as x,i as L,N as M,o as l,a as t,d as a,f as d,t as i,F as E,g as k,e as S,s as N,z as A,v as P,b as v}from"./app-BRWZXJYU.js";import{A as $}from"./AppLayout-9nmr4Y98.js";import{P as B}from"./Pagination-DHwCCrK_.js";import R from"./EditInvoiceItem-BcrwvjI3.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CmqIXznL.js";const j=D({components:{AppLayout:$,Pagination:B,Link:L,EditInvoiceItem:R},props:{invoiceItems:Object,invoices:Object},data(){return{showEditModal:!1,selectedItem:null,filters:{type:"",search:""}}},computed:{filteredItems(){return this.invoiceItems.data.filter(s=>{const e=!this.filters.type||s.type===this.filters.type,n=!this.filters.search||s.customer.name.toLowerCase().includes(this.filters.search.toLowerCase());return e&&n})}},methods:{formatDate(s){return s?new Date(s).toLocaleDateString():""},openEditModal(s){console.log(s),this.selectedItem=s,this.showEditModal=!0},closeEditModal(){this.showEditModal=!1,this.selectedItem=null},deleteItem(s){confirm("Are you sure you want to delete this item?")&&M.delete(route("invoiceItems.destroy",s.id),{onSuccess:e=>{Toast.fire({icon:"success",title:e.props.flash.message}),closeModal()},onError:e=>{console.error("Error submitting form:",e)}})},formatNumber(s){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0)},doExcel(){var e;let s=Object.create({});s.id=(e=this.invoiceItems.data[0])==null?void 0:e.invoice_id,axios.post("/exportBillingItemExcel",s,{responseType:"blob"}).then(n=>{var c,p,m,u;console.log(n);var f=document.createElement("a");document.body.appendChild(f),f.style="display: none";var y=new Blob([n.data],{type:n.headers["content-type"]});const r=document.createElement("a");r.href=window.URL.createObjectURL(y),r.download=`billings_${(c=this.invoiceItems.data[0].invoice.isp)==null?void 0:c.name}_${(u=(m=(p=this.invoiceItems.data[0])==null?void 0:p.invoice)==null?void 0:m.bill)==null?void 0:u.bill_number}_${new Date().toISOString().split("T")[0]}.xlsx`,r.click()})}}}),O={class:"py-12"},U={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},V={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},q={key:0,class:"mb-6 grid grid-cols-4 gap-4"},z={class:"space-y-2"},Q={class:"text-lg space-y-1"},Y={class:"space-y-2"},G={class:"grid grid-cols-2 gap-2"},H={class:"bg-blue-50 rounded p-2 text-center"},J={class:"text-lg font-semibold text-blue-700"},K={class:"bg-blue-50 rounded p-2 text-center"},W={class:"text-lg font-semibold text-blue-700"},X={class:"bg-green-50 rounded p-2 text-center"},Z={class:"text-lg font-semibold text-green-700"},tt={class:"bg-green-50 rounded p-2 text-center"},et={class:"text-lg font-semibold text-green-700"},st={class:"bg-yellow-50 rounded p-2 text-center"},ot={class:"text-lg font-semibold text-yellow-700"},it={class:"bg-yellow-50 rounded p-2 text-center"},nt={class:"text-lg font-semibold text-yellow-700"},lt={class:"space-y-2 col-span-2"},at={class:"bg-gray-50 rounded p-2 text-sm"},dt={class:"col-span-2 truncate"},rt={class:"text-center"},ct={class:"text-right"},pt={class:"text-right font-medium"},mt={class:"mt-8"},ut={class:"flex justify-between items-center mb-4"},gt={class:"flex space-x-4"},ft={class:"w-48"},xt={class:"w-64"},vt={class:"overflow-x-auto"},yt={class:"min-w-full divide-y divide-gray-200"},ht={class:"bg-white divide-y divide-gray-200"},bt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"px-6 py-4 whitespace-nowrap"},_t={class:"px-6 py-4 whitespace-nowrap"},It={class:"px-6 py-4 whitespace-nowrap"},Et={class:"px-6 py-4 whitespace-nowrap"},kt={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"px-6 py-4 whitespace-nowrap"},Ct=["onClick"],Dt=["onClick"],Tt={class:"mt-4"},Lt={class:"mt-6 flex justify-end space-x-3"};function Mt(s,e,n,f,y,r){const c=g("Pagination"),p=g("Link"),m=g("EditInvoiceItem"),u=g("AppLayout");return l(),T(u,{title:"Invoice Details"},{header:x(()=>e[3]||(e[3]=[t("h2",{class:"font-semibold text-xl text-white leading-tight"}," Invoice Details ",-1)])),default:x(()=>{var h,b,w,_,I;return[t("div",O,[t("div",U,[t("div",V,[s.invoiceItems.data.length>0?(l(),a("div",q,[t("div",z,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold"},"Invoice Info",-1)),t("div",Q,[t("p",null,[e[4]||(e[4]=t("span",{class:"font-medium"},"ISP:",-1)),d(" "+i((h=s.invoiceItems.data[0].invoice.isp)==null?void 0:h.name),1)]),t("p",null,[e[5]||(e[5]=t("span",{class:"font-medium"},"Bill Period:",-1)),d(" "+i((w=(b=s.invoiceItems.data[0].invoice)==null?void 0:b.temp_bill)==null?void 0:w.billing_period),1)]),t("p",null,[e[6]||(e[6]=t("span",{class:"font-medium"},"Status:",-1)),d(" "+i((I=(_=s.invoiceItems.data[0].invoice)==null?void 0:_.temp_bill)==null?void 0:I.status),1)])])]),t("div",Y,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold"},"Summary Overview",-1)),t("div",G,[t("div",H,[e[8]||(e[8]=t("p",{class:"text-xs text-blue-600"},"MRC",-1)),t("p",J,i(s.invoiceItems.data[0].invoice.total_mrc_customer),1)]),t("div",K,[e[9]||(e[9]=t("p",{class:"text-xs text-blue-600"},"Total MRC Amount",-1)),t("p",W,i(s.formatNumber(s.invoiceItems.data[0].invoice.total_mrc_amount)),1)]),t("div",X,[e[10]||(e[10]=t("p",{class:"text-xs text-green-600"},"New",-1)),t("p",Z,i(s.invoiceItems.data[0].invoice.total_new_customer),1)]),t("div",tt,[e[11]||(e[11]=t("p",{class:"text-xs text-green-600"},"Total New Amount",-1)),t("p",et,i(s.formatNumber(s.invoiceItems.data[0].invoice.total_installation_amount)),1)]),t("div",st,[e[12]||(e[12]=t("p",{class:"text-xs text-yellow-600"},"Additional",-1)),t("p",ot,i(s.invoiceItems.data[0].invoice.additional_description),1)]),t("div",it,[e[13]||(e[13]=t("p",{class:"text-xs text-yellow-600"},"Total New Amount",-1)),t("p",nt,i(s.formatNumber(s.invoiceItems.data[0].invoice.additional_fees)),1)])])]),t("div",lt,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold"},"Summary Brakedown",-1)),t("div",at,[e[15]||(e[15]=t("div",{class:"grid grid-cols-5 gap-2 border-b border-gray-200 pb-1 mb-1"},[t("div",{class:"col-span-2 font-medium text-gray-600"},"Description"),t("div",{class:"text-center font-medium text-gray-600"},"QTY"),t("div",{class:"text-right font-medium text-gray-600"},"Price"),t("div",{class:"text-right font-medium text-gray-600"},"Total")],-1)),(l(!0),a(E,null,k(s.invoices,o=>(l(),a("div",{key:o.category,class:"grid grid-cols-5 gap-2 py-1 hover:bg-gray-100"},[t("div",dt,i(o.category),1),t("div",rt,i(o.total_customers),1),t("div",ct,i(s.formatNumber(o.unit_price)),1),t("div",pt,i(s.formatNumber(o.total_amount)),1)]))),128))])])])):S("",!0),t("div",mt,[t("div",ut,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold"},"Invoice Items",-1)),t("div",gt,[t("div",ft,[N(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.filters.type=o),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},e[17]||(e[17]=[t("option",{value:""},"All Types",-1),t("option",{value:"FullRecurring"},"Full Recurring",-1),t("option",{value:"ProRatedRecurring"},"Pro-rated Recurring",-1),t("option",{value:"NewInstallation"},"New Installation",-1)]),512),[[A,s.filters.type]])]),t("div",xt,[N(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.filters.search=o),type:"text",placeholder:"Search customer name...",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[P,s.filters.search]])]),t("div",null,[t("a",{onClick:e[2]||(e[2]=(...o)=>s.doExcel&&s.doExcel(...o)),class:"cursor-pointer inline-flex items-center px-2 py-2 bg-green-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:ring focus:ring-green-300 disabled:opacity-25 transition"},e[18]||(e[18]=[d("Export "),t("i",{class:"ml-1 fa fa-download text-white"},null,-1)]))])])]),t("div",vt,[t("table",yt,[e[20]||(e[20]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Customer"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Period"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Unit Price"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Total"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),t("tbody",ht,[(l(!0),a(E,null,k(s.filteredItems,o=>(l(),a("tr",{key:o.id,class:"hover:bg-gray-50"},[t("td",bt,i(o.customer.ftth_id),1),t("td",wt,i(o.customer.name),1),t("td",_t,i(o.type),1),t("td",It,i(s.formatDate(o.start_date))+" - "+i(s.formatDate(o.end_date)),1),t("td",Et,"$"+i(o.unit_price),1),t("td",kt,"$"+i(o.total_amount),1),t("td",Nt,[t("button",{onClick:C=>s.openEditModal(o),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,Ct),t("button",{onClick:C=>s.deleteItem(o),class:"text-red-600 hover:text-red-900"}," Delete ",8,Dt)])]))),128))])])]),t("div",Tt,[v(c,{links:s.invoiceItems.links},null,8,["links"])])]),t("div",Lt,[v(p,{href:s.route("showbill.show",{bill_id:s.invoiceItems.data[0].invoice.bill_id}),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"},{default:x(()=>e[21]||(e[21]=[d(" Back to List ")])),_:1},8,["href"])])])])]),v(m,{show:s.showEditModal,invoiceItem:s.selectedItem,onClose:s.closeEditModal},null,8,["show","invoiceItem","onClose"])]}),_:1})}const Ft=F(j,[["render",Mt]]);export{Ft as default};
