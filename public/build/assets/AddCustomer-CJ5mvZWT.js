import{A as H}from"./AppLayout-DQMHUDA-.js";import{M as K}from"./vue3-multiselect.umd.min-BtFOAPRA.js";import{i as Y,r as u,T as X,m as k,p as G,q as O,c as J,w as V,N as Q,o as v,a as e,h as W,f as c,s as a,v as f,x as m,t as p,d as S,b as P,e as N,y as D}from"./app-DdoqqyeN.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DupIRA2Y.js";const $={name:"AddCustomer",components:{AppLayout:H,Multiselect:K,Link:Y},props:{packages:Object,townships:Object,projects:Object,status_list:Object,subcoms:Object,dn:Object,pops:Object,max_id:Array,errors:Object,user:Object,bundle_equiptments:Object,partners:Object,isps:Object,userPerm:Array},setup(l){let t=u(""),g=u(""),s=u(!1);const j=u(null),w=u([]),b=u([]),x=u([]),o=X({id:null,name:"",phone_1:"",address:"",latitude:"",longitude:"",order_date:"",installation_date:"",ftth_id:"",package:"",status:"",subcom:"",township:"",prefer_install_date:"",pop_id:"",dn_id:"",sn_id:"",splitter_no:"",installation_remark:"",fc_used:"",fc_damaged:"",onu_serial:"",onu_power:"",fiber_distance:"",vlan:"",bundles:"",pop_device_id:"",gpon_ontid:"",port_balance:"",order_remark:"",partner_id:"",created_by:"",isp_id:"",installation_timeline:48});function n(){o.reset()}const C=u(Array.from({length:16},(r,d)=>({id:d+1,name:`SN Port ${d+1}`}))),U=u(Array.from({length:127},(r,d)=>({id:d,name:`OnuID${d}`})));function I(){o._method="POST",Q.post("/customer",o,{preserveState:!0,onSuccess:r=>{console.log("success.. "),Toast.fire({icon:"success",title:r.props.flash.message})},onError:r=>{console.log("error ..".errors)}})}function A(r){r=r||window.event;var d=r.which?r.which:r.keyCode;if(d>31&&(d<48||d>57)&&d!==46)r.preventDefault();else return!0}function F(r){var i;const d=(i=l.user)==null?void 0:i.role;return d&&d!=null&&d.read_customer?!0:!l.userPerm.includes(r)}function T(){let r=o.township.city_code,d=o.township.city_id;var i=l.max_id.filter(_=>_.id==d)[0];o.ftth_id=r+("000000"+(parseInt(i.value)+1)).slice(-6)+"FX"}function B(){o.pppoe_account||o.ftth_id&&o.township&&(o.pppoe_account=o.ftth_id,s.value=!0)}function q(r){r=r.replace(/\(.*?\)/g,"").trim();const d=r.split(/\s+/);let i="";for(let y=0;y<d.length&&(i+=d[y][0].toUpperCase(),i.length!==3);y++);const _=new Date().getFullYear();return i.padEnd(3,i[i.length-1]||"")+"@"+_+"FIP"}function z(){o.pppoe_password||o.ftth_id&&o.name&&o.pppoe_account&&(o.pppoe_password=q(o.name))}function L(r){return Array.isArray(r)?(console.log("array"),r.length===0?(console.log("empty array"),!0):r.every(d=>typeof d=="object"&&Object.keys(d).length===0)):r&&typeof r=="object"?Object.keys(r).length===0:!1}const M=async()=>{if(!o.pop_id){w.value=[];return}try{const d=await(await fetch(`/getOLTByPOP/${o.pop_id.id}`)).json();w.value=d||[]}catch(r){console.error("Failed to fetch POP devices",r)}},E=async()=>{if(!o.pop_device_id){b.value=[];return}try{const d=await(await fetch(`/getDNByOLT/${o.pop_device_id.id}`)).json();b.value=d||[]}catch(r){console.error("Failed to fetch DNs",r)}},R=async()=>{if(!o.dn_id){x.value=[];return}try{const d=await(await fetch(`/getDnId/${o.dn_id.id}`)).json();x.value=d||[]}catch(r){console.error("Failed to fetch SNs",r)}},h=u([]);return k(()=>o.township,async r=>{var d;if(r&&((d=l.user)==null?void 0:d.user_type)=="internal")try{o.pop_id=null,o.pop_device_id=null,o.dn_id=null,o.sn_id=null,r.partner_id&&(o.partner=l.partners.find(y=>y.id===r.partner_id));const _=await(await fetch(`/getPOPsByTownship/${r.id}`)).json();h.value=_||[]}catch(i){console.error("Failed to fetch POPs for township",i),h.value=[]}else h.value=[],o.partner=null}),k(()=>o.pop_id,()=>{M(),o.sn_id=null,o.dn_id=null,o.pop_device_id=null,o.gpon_frame=null,o.gpon_slot=null,o.gpon_port=null,o.gpon_ontid=null,o.port_balance=null}),k(()=>o.pop_device_id,()=>{E(),o.dn_id=null,o.sn_id=null}),k(()=>o.dn_id,()=>{R(),j.value=`Frame${o.dn_id.gpon_frame}/Slot${o.dn_id.gpon_slot}/Port${o.dn_id.gpon_port}`,o.sn_id=null}),G(()=>{o.status=l.status_list[0]}),{form:o,submit:I,resetForm:n,isNumber:A,checkPerm:F,goID:T,fillPppoe:B,pppoe_auto:s,generatePassword:z,res_packages:g,isEmptyObject:L,pop_devices:t,snPortNoOptions:C,gponOnuIdOptions:U,dnInfo:j,popDevices:w,dnOptions:b,snOptions:x,filteredPops:h}}},ee={class:"py-2"},te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},se={class:"mt-5 md:mt-0"},oe={class:"shadow sm:rounded-md sm:overflow-hidden"},re={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},ne={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},le={class:"col-span-1 sm:col-span-1"},de={class:"mt-1 flex rounded-md shadow-sm"},ae=["disabled"],ie={class:"col-span-1 sm:col-span-1"},me={key:0,class:"mt-1 flex rounded-md shadow-sm"},pe={class:"col-span-1 sm:col-span-2"},ue={class:"mt-1 flex rounded-md shadow-sm"},ce=["disabled"],fe={class:"col-span-1 sm:col-span-1"},ge={class:"mt-1 flex rounded-md shadow-sm"},be=["disabled"],xe={class:"col-span-1 sm:col-span-1"},_e={class:"mt-1 flex rounded-md shadow-sm"},ye=["disabled"],we={class:"col-span-1 sm:col-span-2"},he={class:"mt-1 flex rounded-md shadow-sm"},ke=["disabled"],ve={class:"grid grid-cols-1 sm:grid-cols-4 gap-2"},Pe={class:"col-span-1 sm:col-span-1 w-full"},je={class:"mt-1 flex rounded-md shadow-sm"},Oe=["disabled"],Ve={class:"col-span-1 sm:col-span-1"},Se={class:"mt-1 flex rounded-md shadow-sm"},Ne=["min","disabled"],De={class:"col-span-1 sm:col-span-1"},Ce={key:0,class:"mt-1 flex rounded-md shadow-sm"},Ue={class:"col-span-1 sm:col-span-1"},Ie={class:"mt-1 p-2 space-x-2 inline-flex"},Ae={class:"flex items-center"},Fe=["disabled"],Te={class:"flex items-center"},Be=["disabled"],qe={class:"col-span-1 sm:col-span-1"},ze={class:"mt-1 flex rounded-md shadow-sm"},Le=["min","disabled"],Me={class:"col-span-1 sm:col-span-1"},Ee={key:0,class:"mt-1 flex rounded-md shadow-sm"},Re={class:"col-span-1 sm:col-span-2"},He={class:"mt-1 flex rounded-md shadow-sm"},Ke=["disabled"],Ye={class:"px-4 py-3 bg-gray-50 text-right sm:px-6"};function Xe(l,t,g,s,j,w){const b=O("multiselect"),x=O("Link"),o=O("app-layout");return v(),J(o,null,{header:V(()=>t[18]||(t[18]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"},"Customer Details",-1)])),default:V(()=>[e("div",ee,[e("div",te,[e("div",se,[e("form",{onSubmit:t[17]||(t[17]=W((...n)=>s.submit&&s.submit(...n),["prevent"]))},[e("div",oe,[e("div",re,[t[42]||(t[42]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Customer Basic Information",-1)),e("div",ne,[e("div",le,[t[20]||(t[20]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Name ")],-1)),e("div",de,[t[19]||(t[19]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),a(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=n=>s.form.name=n),name:"name",id:"name",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Customer Name",required:"",disabled:s.checkPerm("name")},null,8,ae),[[f,s.form.name]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.name),513),[[m,l.$page.props.errors.name]])]),e("div",ie,[t[21]||(t[21]=e("label",{for:"township",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Township ")],-1)),g.townships.length!==0?(v(),S("div",me,[P(b,{"deselect-label":"Selected already",options:g.townships,"track-by":"id",label:"name",modelValue:s.form.township,"onUpdate:modelValue":t[1]||(t[1]=n=>s.form.township=n),placeholder:"Select Township","allow-empty":!1,disabled:s.checkPerm("township_id"),required:""},null,8,["options","modelValue","disabled"])])):N("",!0),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.township_id),513),[[m,l.$page.props.errors.township_id]])]),e("div",pe,[t[23]||(t[23]=e("label",{for:"phone_1",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Phone No. (e.g. 09-123/09-456)")],-1)),e("div",ue,[t[22]||(t[22]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-phone"})],-1)),a(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=n=>s.form.phone_1=n),name:"phone_1",id:"phone_1",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"e.g 0945000111",required:"",disabled:s.checkPerm("phone_1")},null,8,ce),[[f,s.form.phone_1]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.phone_1),513),[[m,l.$page.props.errors.phone_1]])]),e("div",fe,[t[25]||(t[25]=e("label",{for:"latitude",class:"block text-sm font-medium text-gray-700"},"Latitude ",-1)),e("div",ge,[t[24]||(t[24]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),a(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=n=>s.form.latitude=n),name:"latitude",id:"latitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:t[4]||(t[4]=n=>s.isNumber(l.event)),disabled:s.checkPerm("location")},null,40,be),[[f,s.form.latitude]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.latitude),513),[[m,l.$page.props.errors.latitude]])]),e("div",xe,[t[27]||(t[27]=e("label",{for:"longitude",class:"block text-sm font-medium text-gray-700"},"Longitude ",-1)),e("div",_e,[t[26]||(t[26]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-3"},[e("i",{class:"fas fa-location-arrow"})],-1)),a(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>s.form.longitude=n),name:"longitude",id:"longitude",class:"pl-10 mt-1 form-input focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",onKeypress:t[6]||(t[6]=n=>s.isNumber(l.event)),disabled:s.checkPerm("location")},null,40,ye),[[f,s.form.longitude]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.longitude),513),[[m,l.$page.props.errors.longitude]])]),e("div",we,[t[29]||(t[29]=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Full Address ")],-1)),e("div",he,[t[28]||(t[28]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-map-marker-alt"})],-1)),a(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=n=>s.form.address=n),name:"address",id:"address",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:s.checkPerm("address")},null,8,ke),[[f,s.form.address]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.address),513),[[m,l.$page.props.errors.address]])])]),t[43]||(t[43]=e("hr",{class:"my-4 md:min-w-full"},null,-1)),t[44]||(t[44]=e("h6",{class:"md:min-w-full text-indigo-700 text-xs uppercase font-bold block pt-1 no-underline"}," Order Information",-1)),e("div",ve,[e("div",Pe,[t[31]||(t[31]=e("label",{for:"ftth_id",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer ID ")],-1)),e("div",je,[t[30]||(t[30]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-id-badge"})],-1)),a(e("input",{"onUpdate:modelValue":t[8]||(t[8]=n=>s.form.ftth_id=n),type:"text",name:"ftth_id",id:"ftth_id",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:s.checkPerm("ftth_id")},null,8,Oe),[[f,s.form.ftth_id]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.ftth_id),513),[[m,l.$page.props.errors.ftth_id]])]),e("div",Ve,[t[32]||(t[32]=e("label",{for:"order_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Order Date ")],-1)),e("div",Se,[a(e("input",{type:"date","onUpdate:modelValue":t[9]||(t[9]=n=>s.form.order_date=n),name:"order_date",id:"order_date",min:new Date().toISOString().split("T")[0],class:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",required:"",disabled:s.checkPerm("order_date")},null,8,Ne),[[f,s.form.order_date]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.order_date),513),[[m,l.$page.props.errors.order_date]])]),e("div",De,[t[33]||(t[33]=e("label",{for:"package",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Package ")],-1)),g.packages?(v(),S("div",Ce,[P(b,{"deselect-label":"Selected already",options:g.packages,"track-by":"id",label:"name",modelValue:s.form.package,"onUpdate:modelValue":t[10]||(t[10]=n=>s.form.package=n),"allow-empty":!1,disabled:s.checkPerm("package_id")},null,8,["options","modelValue","disabled"])])):N("",!0),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.package),513),[[m,l.$page.props.errors.package]])]),e("div",Ue,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700"}," Installation Timeline ",-1)),e("div",Ie,[e("div",Ae,[a(e("input",{type:"radio",id:"24hours",name:"installation_timeline",value:"24","onUpdate:modelValue":t[11]||(t[11]=n=>s.form.installation_timeline=n),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300",disabled:s.checkPerm("installation_timeline")},null,8,Fe),[[D,s.form.installation_timeline]]),t[34]||(t[34]=e("label",{for:"24hours",class:"ml-2 text-sm text-gray-700"},"24 Hours",-1))]),e("div",Te,[a(e("input",{type:"radio",id:"48hours",name:"installation_timeline",value:"48","onUpdate:modelValue":t[12]||(t[12]=n=>s.form.installation_timeline=n),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300",disabled:s.checkPerm("installation_timeline")},null,8,Be),[[D,s.form.installation_timeline]]),t[35]||(t[35]=e("label",{for:"48hours",class:"ml-2 text-sm text-gray-700"},"48 Hours",-1))])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.installation_timeline),513),[[m,l.$page.props.errors.installation_timeline]])]),e("div",qe,[t[38]||(t[38]=e("label",{for:"prefer_install_date",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Prefer Installation Date ")],-1)),e("div",ze,[t[37]||(t[37]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-tools"})],-1)),a(e("input",{"onUpdate:modelValue":t[13]||(t[13]=n=>s.form.prefer_install_date=n),type:"date",name:"prefer_install_date",id:"prefer_install_date",min:new Date().toISOString().split("T")[0],class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:s.checkPerm("prefer_install_date")},null,8,Le),[[f,s.form.prefer_install_date]])])]),e("div",Me,[t[39]||(t[39]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},[e("span",{class:"text-red-500"},"*"),c(" Customer Status ")],-1)),g.status_list.length!==0?(v(),S("div",Ee,[P(b,{"deselect-label":"Selected already",options:g.status_list,"track-by":"id",label:"name",modelValue:s.form.status,"onUpdate:modelValue":t[14]||(t[14]=n=>s.form.status=n),"allow-empty":!1,disabled:s.checkPerm("status_id")},null,8,["options","modelValue","disabled"])])):N("",!0),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.status),513),[[m,l.$page.props.errors.status]])]),e("div",Re,[t[41]||(t[41]=e("label",{for:"order_remark",class:"block text-sm font-medium text-gray-700"}," Order Remark ",-1)),e("div",He,[t[40]||(t[40]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-comment"})],-1)),a(e("textarea",{name:"order_remark","onUpdate:modelValue":t[15]||(t[15]=n=>s.form.order_remark=n),id:"order_remark",class:"pl-10 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",disabled:s.checkPerm("order_remark")},null,8,Ke),[[f,s.form.order_remark]])]),a(e("p",{class:"mt-2 text-sm text-red-500"},p(l.$page.props.errors.order_remark),513),[[m,l.$page.props.errors.order_remark]])])])]),e("div",Ye,[P(x,{href:l.route("customer.index"),class:"inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},{default:V(()=>t[45]||(t[45]=[c("Back")])),_:1},8,["href"]),e("button",{onClick:t[16]||(t[16]=(...n)=>s.resetForm&&s.resetForm(...n)),type:"button",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gray-600 hover:bg-gray-700 shadow-sm focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150"},"Reset"),t[46]||(t[46]=e("button",{"wire:click.prevent":"submit",type:"submit",class:"ml-2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Save",-1))])])],32)])])])]),_:1})}const $e=Z($,[["render",Xe]]);export{$e as default};
